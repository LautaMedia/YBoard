<?php include($viewFilesPath . '/Snippets/BoardHeader.phtml') ?>
<?php include($viewFilesPath . '/Snippets/BoardNavigation.phtml') ?>

<?php include($viewFilesPath . '/Snippets/PostForm.phtml') ?>

<?php if (!empty($threads)) : ?>
    <?php foreach($threads as $thread) : ?>
    <div class="content-box thread" id="thread-<?= $thread->id ?>" data-id="<?= $thread->id ?>">
        <?php include($viewFilesPath . '/Snippets/ThreadSubject.phtml') ?>
        <div class="thread-content">
            <div class="post op-post<?= ($thread->userId==$user->id?' own-post':'') ?>" id="post-<?= $thread->id ?>">
                <?php $post = $thread; include($viewFilesPath . '/Snippets/Post.phtml') ?>
            </div>

            <?php include($viewFilesPath . '/Snippets/ThreadMeta.phtml') ?>
            <div class="replies">
            <?php if (!empty($thread->threadReplies)) : ?>
                <div class="replies-buttons">
                    <?php if ($thread->statistics->replyCount > $previewPosts) : ?>
                    <button class="link more-replies" onclick="getMoreReplies(<?= $thread->id ?>)"><?= _('show more replies') ?></button>
                    <button class="link less-replies" onclick="getMoreReplies(<?= $thread->id ?>)"><?= _('show less replies') ?></button>
                    <?php endif ?>
                </div>
                <div class="more-replies-container"></div>
                <?php foreach($thread->threadReplies as $reply) : ?>
                    <div class="post reply<?= ($thread->userId==$user->id?' own-post':'') ?>" id="post-<?= $reply->id ?>">
                        <?php $post = $reply; include($viewFilesPath . '/Snippets/Post.phtml') ?>
                    </div>
                <?php endforeach ?>
            <?php endif ?>
            </div>
            <div class="thread-buttons">
                <!--<a href="/<?= $board->url ?>/<?= $thread->id ?>">avaa lanka</a>-->
                <?php if (!$thread->locked || $user->isMod) : ?>
                <button class="link add-reply" onclick="replyToThread(<?= $thread->id ?>)"><?= _('reply') ?></button>
                <button class="link" onclick="getNewReplies(<?= $thread->id ?>, true)"><?= _('update') ?></button>
                <?php endif ?>
            </div>
        </div>
    </div>
    <?php endforeach; unset($thread); ?>
<?php else : ?>
    <div class="content-box">
        <h3><?= _('There are no threads here...') ?></h3>
    </div>
<?php endif ?>

<?php include($viewFilesPath . '/Snippets/BoardNavigation.phtml') ?>

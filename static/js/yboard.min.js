!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){o(this,e),this.ajaxOptions={method:"GET",url:"",data:null,timeout:0,loadFunction:null,timeoutFunction:null,errorFunction:null,loadendFunction:null,cache:!1,contentType:null,xhr:null},this.ajaxHeaders={"X-Requested-With":"XMLHttpRequest"}}return i(e,[{key:"on",value:function(e,t,n){return document.addEventListener(e,function(e){t&&!e.target.matches(t)||n(e)}),this}},{key:"ajaxSetup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.ajaxOptions=Object.assign(this.ajaxOptions,e),this.ajaxHeaders=Object.assign(this.ajaxHeaders,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=Object.assign({url:e},t),n=Object.assign({},this.ajaxHeaders,n),this.ajax(t,n)}},{key:"post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n=Object.assign({method:"POST",url:e,data:t},n),o=Object.assign({},this.ajaxHeaders,o),this.ajax(n,o)}},{key:"ajax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(e=Object.assign({},this.ajaxOptions,e)).cache||(t=Object.assign(t,{"Cache-Control":"no-cache, max-age=0"}));var n=new XMLHttpRequest;n.timeout=e.timeout,n.open(e.method,e.url);for(var o in t)t.hasOwnProperty(o)&&n.setRequestHeader(o,t[o]);if(this.onEnd=function(e){return n.addEventListener("loadend",function(){e(n)}),this},"function"==typeof e.loadendFunction&&this.onEnd(e.loadendFunction),this.onLoad=function(e){return n.addEventListener("load",function(){200===n.status&&e(n)}),this},"function"==typeof e.loadFunction&&this.onLoad(e.loadFunction),this.onTimeout=function(e){return n.addEventListener("timeout",function(){e(n)}),this},"function"==typeof e.timeoutFunction&&this.onTimeout(e.timeoutFunction),this.onError=function(e){return n.addEventListener("loadend",function(){200!==n.status&&0!==n.status&&e(n)}),this},"function"==typeof e.errorFunction&&this.onError(e.errorFunction),this.getXhrObject=function(){return n},"function"==typeof e.xhr&&(n=e.xhr(n)),"function"!=typeof e.data.append){var i=new FormData;Object.keys(e.data).forEach(function(t){return i.append(t,e.data[t])}),e.data=i}return n.send(e.data),this}},{key:"benchmark",value:function(e,t){void 0===t&&(t=1e5);for(var n=t,o=new Date;t--;)e();var i=new Date-o,r=i/n,a=(1e3/r).toFixed(2);return i+" ms, "+r.toFixed(2)+" ms per op, "+a+" ops/sec"}}]),e}();t.default=new r},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=o(n(0)),l=o(n(8)),u=o(n(2)),c=o(n(4)),d=o(n(14)),f=o(n(9)),h=o(n(15)),p=o(n(11)),m=o(n(12)),v=o(n(10)),g=function(){function e(){i(this,e);var t=this;new f.default,this.Theme=new d.default,this.Thread=new h.default,this.Post=new p.default,this.PostForm=new m.default,this.Notifications=new v.default,this.messagePreviewCache={},this.isBadBrowser()&&this.browserWarning(),document.addEventListener("keydown",function(e){(!e.ctrlKey&&!e.shiftKey&&116===e.which||e.ctrlKey&&!e.shiftKey&&82===e.which)&&(e.preventDefault(),t.pageReload()),e.ctrlKey&&13===e.which&&t.PostForm.submit(e)}),s.default.on("submit","form.ajax",function(e){t.submitForm(e)});var n=document.getElementById("login");null!==n&&(n.querySelector(".e-signup").addEventListener("click",function(e){t.signup(e,!0)}),document.getElementById("signup").querySelector(".cancel").addEventListener("click",function(e){t.signup(e,!1)})),document.getElementById("scroll-to-top").addEventListener("click",function(){window.scrollTo(0,0)}),document.getElementById("scroll-to-bottom").addEventListener("click",function(){window.scrollTo(0,document.body.scrollHeight)}),document.getElementById("reload-page").addEventListener("click",function(){t.pageReload()}),this.initElement(document)}return a(e,[{key:"initElement",value:function(e){var t=this,n=void 0;"function"==typeof e.getElementsByClassName?([].forEach.call(e.getElementsByClassName("datetime"),this.localizeDatetime),[].forEach.call(e.getElementsByClassName("number"),this.localizeNumber),[].forEach.call(e.getElementsByClassName("currency"),this.localizeCurrency),n=Array.prototype.concat.apply([],e.getElementsByClassName("tip")),n=Array.prototype.concat.apply(n,e.getElementsByClassName("ref"))):(e.querySelectorAll(".datetime").forEach(this.localizeDatetime),e.querySelectorAll(".number").forEach(this.localizeNumber),e.querySelectorAll(".currency").forEach(this.localizeCurrency),n=e.querySelectorAll(".tip, .ref")),this.PostForm.bindPostEvents(e),this.Post.truncateLongPosts(e),this.Post.bindEvents(e),n.forEach(function(e){e.addEventListener("mouseover",function(e){var n=null;void 0!==e.target.dataset.id&&(n=e.target.dataset.id);var o=null;new l.default(e,{openDelay:void 0===t.messagePreviewCache[n]?50:0,position:"bottom",content:t.spinnerHtml(),onOpen:function(i){i.elm.style.willChange="contents",void 0!==t.messagePreviewCache[n]?(i.setContent(t.messagePreviewCache[n]),i.position(),i.elm.style.willChange=""):(o=s.default.post("/api/post/get",{postId:n},{errorFunction:null}).onLoad(function(o){if(null!==i.elm){i.setContent(o.responseText),i.position(),i.elm.style.willChange="";var r=e.target.closest(".post");if(null!==r&&(r=r.dataset.id,i.elm.querySelectorAll(".message .ref").length>1)){var a=i.elm.querySelector('.message .ref[data-id="'+r+'"]');null!==a&&a.classList.add("referring")}t.messagePreviewCache[n]=o.responseText}}).onError(function(e){if(0!==e.responseText.length){var t=JSON.parse(e.responseText);i.setContent(t.message)}else i.setContent(messages.errorOccurred);i.position()}),o=o.getXhrObject())},onClose:function(){null!==o&&4!==o.readyState&&o.abort()}})})})}},{key:"localizeDatetime",value:function(e){e.innerHTML=new Date(e.innerHTML.replace(" ","T")+"Z").toLocaleString()}},{key:"localizeNumber",value:function(e){e.innerHTML=parseFloat(e.innerHTML).toLocaleString(void 0,{minimumFractionDigits:0})}},{key:"localizeCurrency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"eur";0===t&&(t="eur"),e.innerHTML=parseFloat(e.innerHTML).toLocaleString(void 0,{style:"currency",currency:t})}},{key:"getSelectionText",value:function(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(e=document.selection.createRange().text),e}},{key:"isBadBrowser",value:function(){return"function"!=typeof FormData||"object"!==("undefined"==typeof localStorage?"undefined":r(localStorage))}},{key:"browserWarning",value:function(){var e=document.createElement("div");e.classList.add("old-browser-warning"),e.innerHTML="<p>"+messages.oldBrowserWarning+"</p>",document.body.appendChild(e)}},{key:"pageReload",value:function(){window.location=window.location.href.split("#")[0]}},{key:"returnToBoard",value:function(){var e=window.location.href;e=e.substr(0,e.lastIndexOf("/")+1),window.location=e}},{key:"spinnerHtml",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return""!==e&&(e+=" "),'<span class="'+e+'loading icon-loading spin"></span>'}},{key:"submitForm",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null!==e&&(e.preventDefault(),t=e.target),!1===n&&void 0!==t.captcha)return void t.captcha.execute();if(!1===t)return!1;if(void 0===t.dataset.action)return!1;var o=new FormData(t);!1!==n&&o.append("captchaResponse",n);var i=document.createElement("div");i.classList.add("form-overlay"),i.innerHTML="<div>"+this.spinnerHtml()+"</div></div>",t.appendChild(i),s.default.post(t.dataset.action,o).onLoad(function(e){var n=JSON.parse(e.responseText);n.reload?n.url?window.location=n.url:window.location.reload():(i.remove(),u.default.success(n.message),t.reset())}).onError(function(){i.remove()}).onEnd(function(){void 0!==t.captcha&&t.captcha.reset()})}},{key:"signup",value:function(e,t){var n=this;e.preventDefault();var o=document.getElementById("login"),i=document.getElementById("signup");t?(i.show("flex"),o.hide(),i.captcha=new c.default(i.querySelector(".captcha"),{size:"invisible",callback:function(e){n.submitForm(null,i,e)}})):(i.hide(),o.show("flex"))}}]),e}();t.default=new g},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.options=Object.assign({displayTime:3e3,fadeTime:2e3},t)}return i(e,[{key:"success",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._show("success",e,t,n)}},{key:"info",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._show("info",e,t,n)}},{key:"warning",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._show("warning",e,t,n)}},{key:"error",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._show("error",e,t,n)}},{key:"_show",value:function(e,t,n,o){var i=this;o=Object.assign({},this.options,o);var r=document.getElementById("toast-root");null===r&&((r=document.createElement("div")).id="toast-root",document.body.appendChild(r));var a=document.createElement("div");a.classList.add("toast",e);var s=document.createElement("div");if(s.classList.add("toast-content"),a.appendChild(s),!1!==n){var l=document.createElement("h3");l.innerHTML=n,s.appendChild(l)}var u=document.createElement("p");u.innerHTML=t,s.appendChild(u),r.appendChild(a),a.addEventListener("click",function(e){e.currentTarget.removeToast()}),a.removeToast=function(){a.remove(),null===r.querySelector(".toast")&&r.remove()},a.startFade=function(){a.classList.add("fading"),a.style.transitionDuration=i.options.fadeTime/1e3+"s"};var c=void 0,d=void 0;c=setTimeout(a.startFade,o.displayTime),d=setTimeout(a.removeToast,o.displayTime+o.fadeTime),a.addEventListener("mouseover",function(e){clearTimeout(c),clearTimeout(d),e.currentTarget.classList.remove("fading"),e.currentTarget.style.transitionDuration=""}),a.addEventListener("mouseout",function(e){c=setTimeout(a.startFade,o.displayTime),d=setTimeout(a.removeToast,o.displayTime+o.fadeTime)})}}]),e}();t.default=new r},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){function t(e){27===e.keyCode&&i.closeLatest()}var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e);var i=this;void 0===window.modals&&(window.modals=[]);var r={};return r.options=Object.assign({content:null,title:null,onOpen:null,onClose:null},n),this.modalRoot=document.getElementById("modal-root"),null===this.modalRoot&&(this.modalRoot=document.createElement("div"),this.modalRoot.id="modal-root",this.modalRoot.addEventListener("click",function(e){e.currentTarget===e.target&&i.closeLatest()}),document.addEventListener("keydown",t),document.body.style.overflow="hidden",document.body.appendChild(this.modalRoot)),r.close=function(){"function"==typeof r.options.onClose&&r.options.onClose(this),r.elm.remove(),null===i.modalRoot.querySelector(".modal")&&(document.removeEventListener("keydown",t),i.modalRoot.remove(),document.body.style.overflow="")},r.setTitle=function(e){r.options.title=e,r.titleTextElm.innerHTML=e},r.setContent=function(e){r.content.innerHTML=e},r.elm=document.createElement("div"),r.elm.classList.add("modal"),this.modalRoot.appendChild(r.elm),r.closeButton=document.createElement("button"),r.closeButton.classList.add("close","icon-cross"),r.closeButton.addEventListener("click",r.close),null!==r.options.title?(r.titleElm=document.createElement("div"),r.titleElm.classList.add("title"),r.elm.appendChild(r.titleElm),r.titleTextElm=document.createElement("span"),r.titleTextElm.innerHTML=r.options.title,r.titleElm.appendChild(r.titleTextElm),r.titleElm.appendChild(r.closeButton)):r.elm.appendChild(r.closeButton),r.content=document.createElement("div"),r.content.classList.add("content"),r.content.innerHTML=r.options.content,r.elm.appendChild(r.content),"function"==typeof r.options.onOpen&&r.options.onOpen(r),window.modals.push(r),r}return i(e,[{key:"closeLatest",value:function(){var e=window.modals.pop();void 0!==e&&e.close()}}]),e}();t.default=r},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),"undefined"!=typeof grecaptcha&&t&&0===t.innerHTML.length&&(n=Object.assign({sitekey:config.reCaptchaPublicKey},n),this.widgetId=grecaptcha.render(t,n))}return i(e,[{key:"execute",value:function(){return"undefined"!=typeof grecaptcha&&(grecaptcha.execute(this.widgetId),!0)}},{key:"reset",value:function(){return"undefined"!=typeof grecaptcha&&(grecaptcha.reset(this.widgetId),!0)}}],[{key:"isEnabled",value:function(){return"undefined"!=typeof grecaptcha}}]),e}();t.default=r},function(e,t,n){"use strict";"function"!=typeof Element.prototype.remove&&(Element.prototype.remove=function(){this.parentElement.removeChild(this)}),"function"!=typeof NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),"function"!=typeof Element.prototype.matches&&(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=this,n=(t.document||t.ownerDocument).querySelectorAll(e),o=0;n[o]&&n[o]!==t;)++o;return Boolean(n[o])}),"function"!=typeof Element.prototype.closest&&(Element.prototype.closest=function(e){for(var t=this;t&&1===t.nodeType;){if(t.matches(e))return t;t=t.parentNode}return null})},function(e,t,n){"use strict";Element.prototype.setAttributes=function(e){for(var t in e){if(!e.hasOwnProperty(t))return!0;this.setAttribute(t,e[t])}},Element.prototype.appendBefore=function(e){e.parentNode.insertBefore(this,e)},Element.prototype.appendAfter=function(e){e.parentNode.insertBefore(this,e.nextSibling)},Element.prototype.toggle=function(){"none"!==window.getComputedStyle(this).display?this.hide():this.show()},Element.prototype.hide=function(){this.style.display="none"},Element.prototype.show=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block";this.style.display=e},Element.prototype.insertAtCaret=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(document.selection){var n=document.selection.createRange();n.text=e+n.text+t,this.focus()}else if(this.selectionStart||0===this.selectionStart){var o=this.value.substr(this.selectionStart,this.selectionEnd-this.selectionStart),i=this.selectionStart,r=this.selectionEnd;this.value=this.value.substr(0,i)+e+o+t+this.value.substr(r,this.value.length),this.selectionStart=i+e.length,this.selectionEnd=i+e.length,this.focus()}else this.value+=e+t,this.focus()},NodeList.prototype.toggle=function(){this.forEach(function(e){e.toggle()})},NodeList.prototype.hide=function(){this.forEach(function(e){e.hide()})},NodeList.prototype.show=function(){this.forEach(function(e){e.show()})},NodeList.prototype.remove=function(){this.forEach(function(e){e.remove()})}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}n(5),n(6);var i=o(n(0)),r=o(n(1)),a=o(n(2)),s=o(n(3));i.default.ajaxSetup({timeout:1e4,errorFunction:function(e){var t=e.responseText,n=messages.errorOccurred;if(0===e.responseText.length&&0===e.readyState&&0===e.status)t=messages.networkError;else if("timeout"===e.responseText)t=messages.timeoutWarning;else try{var o=JSON.parse(e.responseText);t=o.message,void 0!==o.title&&null!==o.title&&0!==o.title.length&&(n=o.title)}catch(n){t=e.responseText}418===e.status?a.default.error(t):a.default.error(t,n)},timeoutFunction:function(e){a.default.error(messages.timeoutWarning)}},{"X-CSRF-Token":"undefined"!=typeof csrfToken?csrfToken:null}),window.YBoard=r.default,window.YQuery=i.default,window.Toast=a.default,window.Modal=s.default},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),this.options=Object.assign({openDelay:100,offset:10,content:"",onOpen:null,onClose:null,closeEvent:"mouseout",position:"bottom"},n),this.x=0,this.y=0,this.spaceAvailable={top:0,right:0,bottom:0,left:0},this.overflows=!1,this.event=t,this.id=0,this.open()}return i(e,[{key:"open",value:function(){var e=this;this.elm=document.createElement("div"),this.elm.classList.add("tooltip"),null!==document.querySelector(".tooltip:last-of-type")&&(this.id=parseInt(document.querySelector(".tooltip:last-of-type").dataset.id)+1),this.elm.dataset.id=this.id,this.setContent(this.options.content);var t=function t(){e.event.target.removeEventListener(e.options.closeEvent,t),e.close(e)};this.event.target.addEventListener(this.options.closeEvent,t),this.event.target.tooltip=this,0!==this.options.openDelay?setTimeout(function(){null!==e.elm&&e.appendTip()},this.options.openDelay):this.appendTip()}},{key:"appendTip",value:function(){document.body.appendChild(this.elm),this.position(),"function"==typeof this.options.onOpen&&this.options.onOpen(this)}},{key:"setContent",value:function(e){null!==this.elm&&(this.elm.innerHTML='<div class="tooltip-content">'+e+"</div>")}},{key:"close",value:function(){"function"==typeof this.options.onClose&&this.options.onClose(this),this.elm=null;var e=document.querySelector('.tooltip[data-id="'+this.id+'"]');null!==e&&e.remove()}},{key:"position",value:function(){null!==this.elm&&(this.targetRect=this.event.target.getBoundingClientRect(),this.tipRect=this.elm.getBoundingClientRect(),this.spaceAvailable={top:this.targetRect.top,right:window.innerWidth-this.targetRect.right,bottom:window.innerHeight-this.targetRect.bottom,left:this.targetRect.left},this.calculatePosition(this.options.position),this.elm.classList.add(this.options.position),this.setPosition())}},{key:"calculatePosition",value:function(e){switch(this.options.position=e,e){case"top":case"bottom":this.x=this.targetRect.right-this.targetRect.width/2-this.tipRect.width/2,this.x<0&&(this.x=0);break;case"right":if(this.x=this.targetRect.right+this.options.offset,this.tipRect.width+this.options.offset>this.spaceAvailable.right){if(!(this.overflows||this.spaceAvailable.left<this.spaceAvailable.right))return this.recalculatePosition("left");this.elm.style.maxWidth=this.spaceAvailable.right-this.options.offset+"px",this.tipRect=this.elm.getBoundingClientRect()}break;case"left":if(this.x=this.targetRect.left-this.tipRect.width-this.options.offset,this.x<0){if(!(this.overflows||this.spaceAvailable.right<this.spaceAvailable.left))return this.recalculatePosition("right");this.elm.style.maxWidth=this.spaceAvailable.left-this.options.offset+"px",this.tipRect=this.elm.getBoundingClientRect()}}switch(e){case"top":if(this.y=this.targetRect.top-this.tipRect.height-this.options.offset,this.y<0){if(!(this.overflows||this.spaceAvailable.bottom<this.spaceAvailable.top))return this.recalculatePosition("bottom");this.y=0,this.elm.style.maxHeight=this.spaceAvailable.top-this.options.offset+"px",this.tipRect=this.elm.getBoundingClientRect()}break;case"bottom":if(this.y=this.targetRect.bottom+this.options.offset,this.tipRect.height+this.options.offset>this.spaceAvailable.bottom){if(!(this.overflows||this.spaceAvailable.top<this.spaceAvailable.bottom))return this.recalculatePosition("top");this.elm.style.maxHeight=this.spaceAvailable.bottom-this.options.offset+"px",this.tipRect=this.elm.getBoundingClientRect()}break;case"right":case"left":this.y=this.targetRect.bottom-this.targetRect.height/2-this.tipRect.height/2,this.y<0&&(this.y=0)}}},{key:"recalculatePosition",value:function(e){this.overflows=!0,this.calculatePosition(e)}},{key:"setPosition",value:function(){this.elm.style.left=window.scrollX+this.x+"px",this.elm.style.top=window.scrollY+this.y+"px"}}]),e}();t.default=r},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){o(this,e);var t=document.getElementById("search-catalog");t&&t.addEventListener("keyup",this.search)}return i(e,[{key:"search",value:function(e){var t=e.target.value,n=document.querySelectorAll(".thread");0===t.length?n.forEach(function(e){e.style.display=""}):(n.hide(),n.forEach(function(e){return-1!==e.querySelector("h3").innerHTML.toLowerCase().indexOf(t.toLowerCase())?(e.show("flex"),!0):-1!==e.querySelector(".message").innerHTML.toLowerCase().indexOf(t.toLowerCase())?(e.show("flex"),!0):void 0}))}}]),e}();t.default=r},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=o(n(3)),s=o(n(1)),l=o(n(0)),u=function(){function e(){i(this,e);var t=this;this.modal=null,document.querySelectorAll(".e-open-notifications").forEach(function(e){e.addEventListener("click",function(){t.open()})})}return r(e,[{key:"open",value:function(){var e=this,t=null;this.modal=new a.default({title:messages.notifications,content:s.default.spinnerHtml(),onOpen:function(n){n.elm.style.willChange="contents",t=l.default.post("/api/user/notification/getall",{},{errorFunction:null}).onLoad(function(t){null!==n.elm&&(n.setContent(t.responseText),n.elm.style.willChange="",e.bindEvents(n.elm),e.updateUnreadCount(e.getUnreadCount(n.elm)))}).onError(function(e){if(0!==e.responseText.length){var t=JSON.parse(e.responseText);n.setContent(t.message)}else n.setContent(messages.errorOccurred)}),t=t.getXhrObject()},onClose:function(){null!==t&&4!==t.readyState&&t.abort()}})}},{key:"bindEvents",value:function(e){var t=this;e.querySelectorAll("a").forEach(function(e){e.addEventListener("click",function(e){if(null!==t.modal&&(void 0!==e.target.tooltip&&e.target.tooltip.close(),t.modal.close()),e.target.classList.contains("not-read")){var n="/api/user/notification/markread",o=new FormData;o.append("id",e.target.closest(".notification").dataset.id),o.append("csrfToken",csrfToken),"sendBeacon"in navigator?navigator.sendBeacon(n,o):(e.preventDefault(),l.default.post(n,o).onLoad(function(){window.location=e.target.getAttribute("href")}))}})}),e.querySelectorAll(".e-mark-all-read").forEach(function(e){e.addEventListener("click",function(e){t.markAllRead(e,t)})}),e.querySelectorAll(".e-mark-read").forEach(function(e){e.addEventListener("click",function(e){t.markRead(e,t)})}),s.default.initElement(e)}},{key:"markRead",value:function(e,t){var n=e.target.closest(".notification");n.classList.remove("not-read"),n.classList.add("is-read"),l.default.post("/api/user/notification/markread",{id:n.dataset.id}).onError(function(){n.classList.add("not-read"),n.classList.remove("is-read")}),t.updateUnreadCount(t.getUnreadCount(e.target.closest(".notification-list")))}},{key:"markAllRead",value:function(e,t){e.target.closest(".modal").querySelectorAll(".notification.not-read").forEach(function(e){e.classList.remove("not-read"),e.classList.add("is-read")}),l.default.post("/api/user/notification/markallread"),t.updateUnreadCount(0),t.modal.close()}},{key:"getUnreadCount",value:function(e){return e.querySelectorAll(".notification.not-read").length}},{key:"updateUnreadCount",value:function(e){(e=parseInt(e))>=100&&(e=":D"),document.querySelectorAll(".unread-notifications").forEach(function(t){t.innerHTML=e,0===e?t.classList.add("none"):t.classList.remove("none")})}}]),e}();t.default=u},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=o(n(0)),s=o(n(1)),l=o(n(2)),u=o(n(13)),c=function(){function e(){i(this,e),this.File=new u.default(this)}return r(e,[{key:"bindEvents",value:function(e){var t=this;this.File.bindEvents(e),e.querySelectorAll(".e-post-delete").forEach(function(e){e.addEventListener("click",t.delete)}),e.querySelectorAll(".ref").forEach(function(e){e.addEventListener("click",t.refClick)})}},{key:"truncateLongPosts",value:function(e){return}},{key:"unTruncate",value:function(e){var t=document.getElementById("post-"+e);if(null!==t){var n=t.querySelector(".message"),o=t.querySelector(".e-untruncate");requestAnimationFrame(function(){n.classList.remove("truncated"),null!==o&&o.remove()})}}},{key:"refClick",value:function(e){var t=e.currentTarget.dataset.id;if(void 0===t)return!0;null!==document.getElementById("post-"+t)&&(e.preventDefault(),document.location.hash="#post-"+t)}},{key:"getElm",value:function(e){return document.getElementById("post-"+e)}},{key:"delete",value:function(e){if(!confirm(messages.confirmDeletePost))return!1;var t=e.target.closest(".post, .thread"),n=t.dataset.id;a.default.post("/api/post/delete",{postId:n}).onLoad(function(){t.remove(),null!==s.default.Thread.getElm(n)&&(document.body.classList.contains("thread-page")?s.default.returnToBoard():s.default.Thread.getElm(n).remove()),l.default.success(messages.postDeleted)})}}]),e}();t.default=c},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=o(n(0)),l=o(n(1)),u=o(n(2)),c=o(n(4)),d=function(){function e(){i(this,e);var t=this;this.elm=document.getElementById("post-form"),null!==this.elm&&(this.captcha=null,this.locationParent=this.elm.parentNode,this.location=this.elm.nextElementSibling,this.msgElm=this.elm.querySelector("#post-message"),this.fileUploadInProgress=!1,this.fileUploadXhr=null,this.submitAfterFileUpload=!1,this.submitInProgress=!1,this.skipUnloadWarning=!1,this.origDestName=!1,this.origDestValue=!1,this.elm.querySelectorAll(".bb-code").forEach(function(e){e.addEventListener("click",function(e){t.insertBbCode(e.target.dataset.code)})}),this.elm.querySelector(".e-postform-color-bar").addEventListener("click",function(){t.toggleBbColorBar()}),document.querySelectorAll(".create-thread").forEach(function(e){e.addEventListener("click",function(){t.show()})}),document.querySelectorAll(".e-thread-reply").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var n=null,o=e.target.closest(".thread");null!==o&&(n=o.dataset.id),t.threadReply(n)})}),this.elm.querySelector("#reset-button").addEventListener("click",function(e){(0===t.msgElm.value.length||confirm(messages.confirmPostCancel))&&(e.preventDefault(),t.reset(!0))}),this.elm.querySelector("#post-files").addEventListener("change",function(){t.uploadFile()}),this.elm.querySelector("#remove-file").addEventListener("click",function(){t.deleteUploadedFile(),t.removeFile()}),this.elm.querySelector(".toggle-options").addEventListener("click",function(e){e.preventDefault(),document.getElementById("post-options").toggle()}),this.elm.addEventListener("submit",function(e){t.submit(e)}),this.elm.querySelectorAll("input, select, textarea").forEach(function(e){e.addEventListener("focus",function(e){t.renderCaptcha()})}),window.addEventListener("beforeunload",function(e){t.skipUnloadWarning||null===t.msgElm||0===t.msgElm.value.length||(e.returnValue=messages.confirmPageLeave)}))}return a(e,[{key:"bindPostEvents",value:function(e){var t=this;e.querySelectorAll(".e-post-reply").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),t.postReply(e.target.closest(".post").dataset.id),t.msgElm.focus()})})}},{key:"show",value:function(e){e||this.reset(),this.renderCaptcha(),this.elm.classList.add("visible"),null!==this.msgElm.offsetParent&&this.msgElm.focus()}},{key:"renderCaptcha",value:function(){var e=this;null===this.captcha&&c.default.isEnabled()&&(this.captcha=new c.default(this.elm.querySelector(".captcha"),{size:"invisible",callback:function(t){e.submit(null,t)}}))}},{key:"hide",value:function(){this.elm.classList.remove("visible")}},{key:"reset",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.elm.reset(),null!==this.location?this.locationParent.insertBefore(this.elm,this.location):this.locationParent.appendChild(this.elm),this.removeFile(),this.resetDestination(),this.hide()}},{key:"focus",value:function(){this.msgElm.focus()}},{key:"setDestination",value:function(e,t){this.saveDestination();var n="board";e&&(n="thread");var o=this.elm.querySelector("#post-destination");o.setAttribute("name",n),o.value=t}},{key:"saveDestination",value:function(){var e=this.elm.querySelector("#post-destination"),t=this.elm.querySelector("#label-board");return null!==t?(t.hide(),t.querySelector("select").required=!1,!0):!!this.origDestName||(this.origDestName=e.getAttribute("name"),this.origDestValue=e.value,!0)}},{key:"resetDestination",value:function(){var e=this.elm.querySelector("#post-destination"),t=this.elm.querySelector("#label-board");return null!==t&&(t.show("flex"),t.querySelector("select").required=!0),!this.origDestName||(e.setAttribute("name",this.origDestName),e.value=this.origDestValue,this.origDestName=!1,this.origDestValue=!1,!0)}},{key:"insertBbCode",value:function(e){this.msgElm.insertAtCaret("["+e+"]","[/"+e+"]")}},{key:"toggleBbColorBar",value:function(){this.elm.querySelector("#color-buttons").toggle(),this.msgElm.focus()}},{key:"uploadFile",value:function(){this.elm.querySelector("#remove-file").show(),this.deleteUploadedFile(),this.removeFile(!0);var e=this.elm.querySelector("#post-files"),t=this.elm.querySelector("#file-name");t.value="",this.submitAfterFileUpload=!1,this.updateFileProgressBar(1);for(var n,o=e.dataset.maxsize,i=e.files,r=0,a=0;n=i[a];a++)r+=n.size;if(r>o)return u.default.warning(messages.maxSizeExceeded),this.updateFileProgressBar(0),!1;var l=new FormData;Array.from(i).forEach(function(e){l.append("files[]",e)}),this.fileUploadInProgress=!0;var c=e.value.split("\\").pop().split(".");c.pop(),t.value=c.join(".");var d=this,f=s.default.post("/api/file/create",l,{timeout:0,contentType:null,xhr:function(e){return e.upload?(e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var t=Math.round(e.loaded/e.total*100);t<0?t=0:t>99&&(t=99),d.updateFileProgressBar(t)}}),e):e}}).onLoad(function(e){d.fileUploadInProgress=!1,d.updateFileProgressBar(100);var t=JSON.parse(e.responseText);0!==t.message.length?(d.elm.querySelector("#file-id").value=t.message[0],d.submitAfterFileUpload&&d.submit()):(u.default.error(messages.errorOccurred),d.removeFile(),d.updateFileProgressBar(0))}).onError(function(){d.removeFile(),d.updateFileProgressBar(0)});this.fileUploadXhr=f.getXhrObject()}},{key:"removeFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null!==this.fileUploadXhr&&(this.fileUploadXhr.abort(),this.fileUploadXhr=null),e||(this.elm.querySelector("#remove-file").hide(),this.elm.querySelector("#post-files").value=""),this.elm.querySelector("#file-id").value="",this.elm.querySelector("#file-name").value="",this.updateFileProgressBar(0),this.elm.querySelector('input[type="submit"].button').disabled=!1,this.fileUploadInProgress=!1,this.submitAfterFileUpload=!1}},{key:"deleteUploadedFile",value:function(){var e=this.elm.querySelector("#file-id");""!==e.value&&s.default.post("/api/file/delete",{fileId:e.value})}},{key:"updateFileProgressBar",value:function(e){e<0?e=0:e>100&&(e=100);var t=this.elm.querySelector(".file-progress"),n=t.querySelector("div");0===e?(n.style.width=0,t.classList.remove("in-progress")):(n.style.width=e+"%",t.classList.add("in-progress"))}},{key:"threadReply",value:function(e){null!==e&&(l.default.Thread.getElm(e).appendChild(this.elm),this.show(!0),this.setDestination(!0,e)),this.msgElm.focus()}},{key:"postReply",value:function(e){var t=l.default.getSelectionText();l.default.Post.getElm(e).appendChild(this.elm),this.show(!0),this.setDestination(!0,this.elm.closest(".thread").dataset.id),this.msgElm.focus();var n="";"\n"!==this.msgElm.value.substr(-1)&&0!==this.msgElm.value.length&&("\n"!==this.msgElm.value.substr(-1)?n+="\n\n":n+="\n"),n+=">>"+e+"\n",""!==t&&(n+=">"+t.replace(/(\r\n|\n|\r)/g,"$1>")+"\n"),this.msgElm.insertAtCaret(n)}},{key:"submit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this;if("object"===(void 0===e?"undefined":r(e))&&null!==e&&e.preventDefault(),null!==this.captcha&&null===t)return console.log(2),void this.captcha.execute();var o=this.elm.querySelector('input[type="submit"].button');if(this.fileUploadInProgress)return u.default.info(messages.waitingForFileUpload),o.disabled=!0,this.submitAfterFileUpload=!0,!1;if(this.submitInProgress)return!1;this.submitInProgress=!0,this.elm.querySelector("#post-files").value="";var i=new FormData(this.elm);i.append("captchaResponse",t),s.default.post("/api/post/create",i,{contentType:null}).onLoad(function(e){var t=document.getElementById("post-destination"),o=void 0;if(null!==(o="thread"!==t.getAttribute("name")?null:t.value))l.default.Thread.AutoUpdate.runOnce(o),n.reset(!0);else if(0===e.responseText.length)n.skipUnloadWarning=!0,l.default.pageReload();else{var r=JSON.parse(e.responseText);void 0===r.message?u.default.error(messages.errorOccurred):(n.skipUnloadWarning=!0,window.location="/"+i.get("board")+"/"+r.message)}}).onEnd(function(){o.disabled=!1,n.submitInProgress=!1,null!==n.captcha&&n.captcha.reset()})}}]),e}();t.default=d},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=o(n(0)),s=o(n(1)),l=o(n(2)),u=function(){function e(t){i(this,e),this.Post=t}return r(e,[{key:"bindEvents",value:function(e){var t=this;e.querySelectorAll(".thumbnail .image").forEach(function(e){e.addEventListener("click",function(e){t.expand(e,t)})}),e.querySelectorAll(".thumbnail .media").forEach(function(e){e.addEventListener("click",function(e){t.playMedia(e,t)})}),e.querySelectorAll(".e-stop-media").forEach(function(e){e.addEventListener("click",t.stopAllMedia)})}},{key:"delete",value:function(e){if(!confirm(messages.confirmDeleteFile))return!1;a.default.post("/api/post/deletefile",{post_id:e,loadFunction:function(){this.getElm(e).find("figure").remove(),l.default.success(messages.fileDeleted)}})}},{key:"expand",value:function(e,t){function n(e,t){function n(e){e.target.removeEventListener("load",o),delete e.target.dataset.expanding,clearTimeout(e.target.loading);var t=e.target.parentNode.querySelector("div.overlay");null!==t&&requestAnimationFrame(function(){t.remove()})}var o=n;e.dataset.expanding=!0,e.loading=setTimeout(function(){var t=document.createElement("div");t.classList.add("overlay","center"),t.innerHTML=s.default.spinnerHtml(),e.parentNode.appendChild(t)},200),e.addEventListener("load",o),e.setAttribute("src",t)}e.preventDefault(),void 0===e.target.dataset.expanded?(e.target.dataset.expanded=e.target.getAttribute("src"),requestAnimationFrame(function(){n(e.target,e.target.parentNode.getAttribute("href")),e.target.closest(".post-file").classList.remove("thumbnail"),t.Post.unTruncate(e.target.closest(".post").dataset.id)})):requestAnimationFrame(function(){n(e.target,e.target.dataset.expanded),e.target.closest(".post-file").classList.add("thumbnail"),delete e.target.dataset.expanded;var t=e.target.getBoundingClientRect().top+window.scrollY;t<window.scrollY&&window.scrollTo(0,t)})}},{key:"playMedia",value:function(e,t){e.preventDefault(),t.stopAllMedia();var n=e.target.closest("figure").dataset.id;if(void 0!==e.target.dataset.loading)return!1;e.target.dataset.loading=!0;var o=setTimeout(function(){var t=document.createElement("div");t.classList.add("overlay","bottom","left"),t.innerHTML=s.default.spinnerHtml(),requestAnimationFrame(function(){e.target.appendChild(t)})},200);a.default.post("/api/file/getmediaplayer",{fileId:n}).onLoad(function(n){var o=e.target.closest(".post-file"),i=e.target.closest(".message");t.Post.unTruncate(e.target.closest(".post").dataset.id),null!==i.nextElementSibling&&i.nextElementSibling.classList.contains("e-untruncate")&&i.nextElementSibling.remove();var r=document.createElement("div");r.innerHTML=n.responseText,s.default.initElement(r),requestAnimationFrame(function(){o.classList.remove("thumbnail"),o.classList.add("media-player-container"),o.insertBefore(r,o.firstElementChild);var e=o.querySelector("video");if(null!==e){e.addEventListener("volumechange",function(e){localStorage.setItem("videoVolume",e.target.volume)});var t=localStorage.getItem("videoVolume");null!==t&&(e.volume=t)}})}).onEnd(function(){clearTimeout(o),e.target.querySelectorAll("div.overlay").forEach(function(e){requestAnimationFrame(function(){e.remove()})}),delete e.target.dataset.loading})}},{key:"stopAllMedia",value:function(){document.querySelectorAll(".media-player-container").forEach(function(e){var t=e.querySelector("video");t.pause(),t.remove(),requestAnimationFrame(function(){e.classList.remove("media-player-container"),e.classList.add("thumbnail")})})}}]),e}();t.default=u},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),a=function(){function e(){o(this,e);var t=this;document.querySelector(".e-switch-theme").addEventListener("click",function(){t.switchVariation()}),document.getElementById("sidebar").addEventListener("click",function(e){e.offsetX>document.getElementById("sidebar").clientWidth&&document.body.classList.toggle("sidebar-visible")}),document.querySelector("#e-sidebar-toggle").addEventListener("click",function(){document.body.classList.toggle("sidebar-visible")}),document.getElementById("e-sidebar-hide").addEventListener("click",function(){t.toggleSidebar()})}return i(e,[{key:"toggleSidebar",value:function(){document.body.classList.toggle("no-sidebar");var e=document.body.classList.contains("no-sidebar");e&&document.body.classList.remove("sidebar-visible"),r.default.post("/api/user/preferences/set",{hideSidebar:e})}},{key:"switchVariation",value:function(){var e=document.querySelectorAll("head .css"),t=(e=e[e.length-1]).dataset.light,n=e.dataset.dark,o=void 0,i=void 0;"true"===e.dataset.darktheme?(o=t,i=!1):(o=n,i=!0);var a=e.cloneNode();a.setAttributes({href:o,"data-darkTheme":i}),a.appendAfter(e);setTimeout(function(){e.remove()},5e3);r.default.post("/api/user/preferences/set",{darkTheme:i})}}]),e}();t.default=a},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=o(n(0)),s=o(n(1)),l=o(n(16)),u=o(n(18)),c=o(n(17)),d=function(){function e(){i(this,e);var t=this;this.AutoUpdate=new l.default,this.Hide=new u.default,this.Follow=new c.default,document.querySelectorAll(".replies-buttons").forEach(function(e){e.querySelector(".e-more-replies").addEventListener("click",t.expand),e.querySelector(".e-less-replies").addEventListener("click",t.shrink)})}return r(e,[{key:"getElm",value:function(e){return document.getElementById("thread-"+e)}},{key:"toggleLock",value:function(e){0==this.getElm(e).find("h3 a .icon-lock").length?$.post("/scripts/threads/lock",{threadId:e}).done(function(){YB.thread.getElm(e).find("h3 a").prepend('<span class="icon-lock icon"></span>'),toastr.success(messages.threadLocked)}):$.post("/scripts/threads/unlock",{threadId:e}).done(function(){YB.thread.getElm(e).find("h3 a .icon-lock").remove(),toastr.success(messages.threadUnlocked)})}},{key:"toggleSticky",value:function(e){0==this.getElm(e).find("h3 a .icon-lock").length?$.post("/scripts/threads/stick",{threadId:e}).done(function(){YB.thread.getElm(e).find("h3 a").prepend('<span class="icon-pushpin icon"></span>'),toastr.success(messages.threadStickied)}):$.post("/scripts/threads/unstick",{threadId:e}).done(function(){YB.thread.getElm(e).find("h3 a .icon-pushpin").remove(),toastr.success(messages.threadUnstickied)})}},{key:"shrink",value:function(e){var t=e.target.closest(".thread");t.querySelector(".more-replies-container").innerHTML="",t.querySelector(".e-more-replies").show(),t.classList.remove("expanded")}},{key:"expand",value:function(e){var t=e.target.closest(".thread"),n=t.dataset.id,o=t.querySelector(".reply").dataset.id;a.default.post("/api/thread/getreplies",{threadId:n,fromId:o,count:100}).onLoad(function(e){var n=document.createElement("div");n.innerHTML=e.responseText,n.querySelectorAll(".post").length<100&&t.querySelector(".e-more-replies").hide();var o=t.querySelector(".more-replies-container"),i=o.querySelector(".reply");null===i?o.appendChild(n):t.querySelector(".more-replies-container").insertBefore(n,i),s.default.initElement(n),t.classList.add("expanded")})}}]),e}();t.default=d},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=o(n(1)),s=o(n(0)),l=o(n(2)),u=function(){function e(){i(this,e);var t=this;this.threadId=!1,this.nextLoadDelay=2e3,this.newReplies=0,this.lastUpdateNewReplies=0,this.runCount=0,this.nowLoading=!1,this.isActive=!1,this.nextRunTimeout=0,this.startDelayTimeout=0,this.originalDocTitle=document.title,document.querySelectorAll(".thread .e-get-replies").forEach(function(e){e.addEventListener("click",function(n){n.preventDefault(),t.runOnce(e.closest(".thread").dataset.id)})})}return r(e,[{key:"run",value:function(e){if(this.nowLoading)return!1;this.nextLoadDelay=this.nextLoadDelay*(0===this.runCount?1:this.runCount),this.nextLoadDelay>3e4&&(this.nextLoadDelay=3e4),this.runCount>40&&this.stop(),e&&(this.runCount=0,this.isActive&&this.restart());var t=a.default.Thread.getElm(this.threadId),n=t.querySelectorAll(".reply");n=0===n.length?0:(n=n[n.length-1]).getAttribute("id").replace("post-",""),this.nowLoading=!0;var o=this;s.default.post("/api/thread/getreplies",{threadId:this.threadId,fromId:n,newest:!0,xhr:function(e){return e.responseType="document",e}}).onLoad(function(n){if(e&&0===n.responseText.length)return void l.default.info(messages.noNewReplies);var i=document.createElement("div");i.classList.add("ajax"),i.innerHTML=n.responseText,o.lastUpdateNewReplies=i.querySelectorAll(".post").length,o.newReplies+=o.lastUpdateNewReplies,0===o.lastUpdateNewReplies?++o.runCount:o.runCount=0,a.default.initElement(i),requestAnimationFrame(function(){t.querySelector(".replies").appendChild(i)}),e||(o.nextRunTimeout=setTimeout(function(){o.start()},o.nextLoadDelay))}).onError(function(){o.stop()}).onEnd(function(){o.nowLoading=!1,!document.hasFocus()&&o.newReplies>0&&document.body.classList.contains("thread-page")?document.title="("+o.newReplies+") "+o.originalDocTitle:0!==o.newReplies&&(o.newReplies=0)})}},{key:"runOnce",value:function(e){this.threadId=e,this.run(!0)}},{key:"start",value:function(){this.isActive=!0,this.startDelayTimeout&&clearTimeout(this.startDelayTimeout);var e=this;return this.threadId=$(".thread:first").data("id"),this.startDelayTimeout=setTimeout(function(){e.run(!1)},1e3),!0}},{key:"stop",value:function(){return!this.isActive||(this.startDelayTimeout&&clearTimeout(this.startDelayTimeout),this.isActive=!1,this.reset(),!0)}},{key:"restart",value:function(){this.stop(),this.start()}},{key:"reset",value:function(){this.nowLoading=!1,this.newReplies=0,this.runCount=0,document.title!==this.originalDocTitle&&(document.title=this.originalDocTitle),this.nextRunTimeout&&clearTimeout(this.nextRunTimeout)}}]),e}();t.default=u},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),a=function(){function e(){o(this,e);var t=this;document.querySelectorAll(".e-thread-follow").forEach(function(e){e.addEventListener("click",t.toggle)}),document.querySelectorAll(".e-follow-mark-read").forEach(function(e){e.addEventListener("click",t.markAllRead)})}return i(e,[{key:"markAllRead",value:function(){document.querySelectorAll(".icon-bookmark .unread-count").forEach(function(e){e.hide()}),document.querySelectorAll("h3 .notification-count").forEach(function(e){e.hide()}),r.default.post("/api/user/thread/follow/markallread").onError(function(){document.querySelectorAll(".icon-bookmark .unread-count").forEach(function(e){e.show()}),document.querySelectorAll("h3 .notification-count").forEach(function(e){e.show()})})}},{key:"toggle",value:function(e){function t(e){e.classList.contains("act")?(e.classList.add("icon-bookmark-add"),e.classList.remove("icon-bookmark-remove","act")):(e.classList.add("icon-bookmark-remove","act"),e.classList.remove("icon-bookmark-add"))}var n=e.target.closest(".thread"),o=e.currentTarget,i=!0;e.currentTarget.classList.contains("act")&&(i=!1),n.classList.toggle("followed"),t(o),r.default.post(i?"/api/user/thread/follow/create":"/api/user/thread/follow/delete",{threadId:n.dataset.id}).onError(function(e){n.classList.toggle("followed"),t(o)})}}]),e}();t.default=a},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){return e&&e.__esModule?e:{default:e}}(n(0)),a=function(){function e(){o(this,e);var t=this;document.querySelectorAll(".e-thread-hide").forEach(function(e){e.addEventListener("click",t.toggle)})}return i(e,[{key:"toggle",value:function(e){function t(e){e.classList.contains("act")?(e.classList.add("icon-eye-crossed"),e.classList.remove("icon-eye","act")):(e.classList.add("icon-eye","act"),e.classList.remove("icon-eye-crossed"))}var n=e.target.closest(".thread"),o=e.currentTarget,i=!0;e.currentTarget.classList.contains("act")&&(i=!1),n.classList.toggle("hidden"),t(o),r.default.post(i?"/api/user/thread/hide/create":"/api/user/thread/hide/delete",{threadId:n.dataset.id}).onError(function(e){n.classList.toggle("hidden"),t(o)})}}]),e}();t.default=a}]);
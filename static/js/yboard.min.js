!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.i=function(value){return value},__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=6)}([function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),YQuery=function(){function YQuery(){_classCallCheck(this,YQuery),this.ajaxOptions={method:"GET",url:"",data:null,timeout:0,loadFunction:null,timeoutFunction:null,errorFunction:null,loadendFunction:null,cache:!1,contentType:null,xhr:null},this.ajaxHeaders={"X-Requested-With":"XMLHttpRequest"}}return _createClass(YQuery,[{key:"on",value:function(eventName,target,fn){return document.addEventListener(eventName,function(event){target&&!event.target.matches(target)||fn(event)}),this}},{key:"ajaxSetup",value:function(options){var headers=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.ajaxOptions=Object.assign(this.ajaxOptions,options),this.ajaxHeaders=Object.assign(this.ajaxHeaders,headers)}},{key:"get",value:function(url){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},headers=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return options=Object.assign({url:url},options),headers=Object.assign({},this.ajaxHeaders,headers),this.ajax(options,headers)}},{key:"post",value:function(url){var data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},headers=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return options=Object.assign({method:"POST",url:url,data:data},options),headers=Object.assign({},this.ajaxHeaders,headers),this.ajax(options,headers)}},{key:"ajax",value:function(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},headers=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(options=Object.assign({},this.ajaxOptions,options)).cache||(headers=Object.assign(headers,{"Cache-Control":"no-cache, max-age=0"}));var xhr=new XMLHttpRequest;xhr.timeout=options.timeout,xhr.open(options.method,options.url);for(var key in headers)headers.hasOwnProperty(key)&&xhr.setRequestHeader(key,headers[key]);if(this.onEnd=function(fn){return xhr.addEventListener("loadend",function(){fn(xhr)}),this},"function"==typeof options.loadendFunction&&this.onEnd(options.loadendFunction),this.onLoad=function(fn){return xhr.addEventListener("load",function(){200===xhr.status&&fn(xhr)}),this},"function"==typeof options.loadFunction&&this.onLoad(options.loadFunction),this.onTimeout=function(fn){return xhr.addEventListener("timeout",function(){fn(xhr)}),this},"function"==typeof options.timeoutFunction&&this.onTimeout(options.timeoutFunction),this.onError=function(fn){return xhr.addEventListener("loadend",function(){200!==xhr.status&&0!==xhr.status&&fn(xhr)}),this},"function"==typeof options.errorFunction&&this.onError(options.errorFunction),this.getXhrObject=function(){return xhr},"function"==typeof options.xhr&&(xhr=options.xhr(xhr)),"function"!=typeof options.data.append){var data=new FormData;Object.keys(options.data).forEach(function(key){return data.append(key,options.data[key])}),options.data=data}return xhr.send(options.data),this}},{key:"benchmark",value:function(fn,iterations){void 0===iterations&&(iterations=1e5);for(var iterationCount=iterations,start=new Date;iterations--;)fn();var totalTime=new Date-start,msPerOp=totalTime/iterationCount,opsPerSec=(1e3/msPerOp).toFixed(2);return totalTime+" ms, "+msPerOp.toFixed(2)+" ms per op, "+opsPerSec+" ops/sec"}}]),YQuery}();exports.default=new YQuery},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Toast=function(){function Toast(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,Toast),this.options=Object.assign({displayTime:3e3,fadeTime:2e3},options)}return _createClass(Toast,[{key:"success",value:function(message){var title=arguments.length>1&&void 0!==arguments[1]&&arguments[1],options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._show("success",message,title,options)}},{key:"info",value:function(message){var title=arguments.length>1&&void 0!==arguments[1]&&arguments[1],options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._show("info",message,title,options)}},{key:"warning",value:function(message){var title=arguments.length>1&&void 0!==arguments[1]&&arguments[1],options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._show("warning",message,title,options)}},{key:"error",value:function(message){var title=arguments.length>1&&void 0!==arguments[1]&&arguments[1],options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._show("error",message,title,options)}},{key:"_show",value:function(type,message,title,options){var that=this;options=Object.assign({},this.options,options);var toastRoot=document.getElementById("toast-root");null===toastRoot&&((toastRoot=document.createElement("div")).id="toast-root",document.body.appendChild(toastRoot));var toast=document.createElement("div");toast.classList.add("toast",type);var toastContent=document.createElement("div");if(toastContent.classList.add("toast-content"),toast.appendChild(toastContent),!1!==title){var toastTitle=document.createElement("h3");toastTitle.innerHTML=title,toastContent.appendChild(toastTitle)}var toastMessage=document.createElement("p");toastMessage.innerHTML=message,toastContent.appendChild(toastMessage),toastRoot.appendChild(toast),toast.addEventListener("click",function(e){e.currentTarget.removeToast()}),toast.removeToast=function(){toast.remove(),null===toastRoot.querySelector(".toast")&&toastRoot.remove()},toast.startFade=function(){toast.classList.add("fading"),toast.style.transitionDuration=that.options.fadeTime/1e3+"s"};var fading=void 0,removing=void 0;fading=setTimeout(toast.startFade,options.displayTime),removing=setTimeout(toast.removeToast,options.displayTime+options.fadeTime),toast.addEventListener("mouseover",function(e){clearTimeout(fading),clearTimeout(removing),e.currentTarget.classList.remove("fading"),e.currentTarget.style.transitionDuration=""}),toast.addEventListener("mouseout",function(e){fading=setTimeout(toast.startFade,options.displayTime),removing=setTimeout(toast.removeToast,options.displayTime+options.fadeTime)})}}]),Toast}();exports.default=new Toast},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_YQuery2=_interopRequireDefault(__webpack_require__(0)),_Captcha2=_interopRequireDefault(__webpack_require__(8)),_Theme2=_interopRequireDefault(__webpack_require__(13)),_Catalog2=_interopRequireDefault(__webpack_require__(9)),_Thread2=_interopRequireDefault(__webpack_require__(14)),_Post2=_interopRequireDefault(__webpack_require__(10)),_PostForm2=_interopRequireDefault(__webpack_require__(11)),_Tooltip2=_interopRequireDefault(__webpack_require__(7)),_Toast2=_interopRequireDefault(__webpack_require__(1)),YBoard=function(){function YBoard(){_classCallCheck(this,YBoard);var that=this;this.Catalog=new _Catalog2.default,this.Captcha=new _Captcha2.default,this.Theme=new _Theme2.default,this.Thread=new _Thread2.default,this.Post=new _Post2.default,this.PostForm=new _PostForm2.default,this.isBadBrowser()&&this.browserWarning(),document.addEventListener("keydown",function(e){(!e.ctrlKey&&!e.shiftKey&&116===e.which||e.ctrlKey&&!e.shiftKey&&82===e.which)&&(e.preventDefault(),that.pageReload()),e.ctrlKey&&13===e.which&&that.PostForm.submit(e)}),_YQuery2.default.on("submit","form.ajax",function(event){that.submitForm(event)});var loginForm=document.getElementById("login");null!==loginForm&&(loginForm.querySelector(".e-signup").addEventListener("click",function(e){that.signup(e,!0)}),document.getElementById("signup").querySelector(".cancel").addEventListener("click",function(e){that.signup(e,!1)})),document.getElementById("e-sidebar-hide").addEventListener("click",function(){that.Theme.toggleSidebar()}),document.getElementById("scroll-to-top").addEventListener("click",function(){window.scrollTo(0,0)}),document.getElementById("scroll-to-bottom").addEventListener("click",function(){window.scrollTo(0,document.body.scrollHeight)}),document.getElementById("reload-page").addEventListener("click",function(){that.pageReload()}),this.initElement(document)}return _createClass(YBoard,[{key:"initElement",value:function(elm){var that=this,tooltips=void 0;"function"==typeof elm.getElementsByClassName?([].forEach.call(elm.getElementsByClassName("datetime"),this.localizeDatetime),[].forEach.call(elm.getElementsByClassName("number"),this.localizeNumber),[].forEach.call(elm.getElementsByClassName("currency"),this.localizeCurrency),tooltips=Array.prototype.concat.apply([],elm.getElementsByClassName("tip")),tooltips=Array.prototype.concat.apply(tooltips,elm.getElementsByClassName("ref"))):(elm.querySelectorAll(".datetime").forEach(this.localizeDatetime),elm.querySelectorAll(".number").forEach(this.localizeNumber),elm.querySelectorAll(".currency").forEach(this.localizeCurrency),tooltips=elm.querySelectorAll(".tip, .ref")),this.PostForm.bindPostEvents(elm),this.Post.truncateLongPosts(elm),this.Post.bindEvents(elm),tooltips.forEach(function(elm){elm.addEventListener("mouseover",function(e){var postId=null;void 0!==e.target.dataset.id&&(postId=e.target.dataset.id),new _Tooltip2.default(e,{openDelay:100,position:"bottom",content:that.spinnerHtml(),onOpen:function(tip){_YQuery2.default.post("/api/post/get",{postId:postId},{errorFunction:null}).onLoad(function(xhr){tip.setContent(xhr.responseText),tip.position()}).onError(function(xhr){if(0!==xhr.responseText.length){var json=JSON.parse(xhr.responseText);tip.setContent(json.message)}else tip.setContent(messages.errorOccurred);tip.position()})}})})})}},{key:"localizeDatetime",value:function(elm){elm.innerHTML=new Date(elm.innerHTML.replace(" ","T")+"Z").toLocaleString()}},{key:"localizeNumber",value:function(elm){elm.innerHTML=parseFloat(elm.innerHTML).toLocaleString(void 0,{minimumFractionDigits:0})}},{key:"localizeCurrency",value:function(elm){var currency=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"eur";0===currency&&(currency="eur"),elm.innerHTML=parseFloat(elm.innerHTML).toLocaleString(void 0,{style:"currency",currency:currency})}},{key:"getSelectionText",value:function(){var text="";return window.getSelection?text=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(text=document.selection.createRange().text),text}},{key:"isBadBrowser",value:function(){return"function"!=typeof FormData||"object"!==("undefined"==typeof localStorage?"undefined":_typeof(localStorage))}},{key:"browserWarning",value:function(){var browserWarning=document.createElement("div");browserWarning.classList.add("old-browser-warning"),browserWarning.innerHTML="<p>"+messages.oldBrowserWarning+"</p>",document.body.appendChild(browserWarning)}},{key:"pageReload",value:function(){window.location=window.location.href.split("#")[0]}},{key:"returnToBoard",value:function(){var url=window.location.href;url=url.substr(0,url.lastIndexOf("/")+1),window.location=url}},{key:"spinnerHtml",value:function(){var classes=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return""!==classes&&(classes+=" "),'<span class="'+classes+'loading icon-loading spin"></span>'}},{key:"submitForm",value:function(e){var form=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!==e&&(e.preventDefault(),form=e.target),!1===form)return!1;var fd=new FormData(form),overlay=document.createElement("div");overlay.classList.add("form-overlay"),overlay.innerHTML="<div>"+this.spinnerHtml()+"</div></div>",form.appendChild(overlay),_YQuery2.default.post(form.getAttribute("action"),fd).onLoad(function(xhr){var data=JSON.parse(xhr.responseText);data.reload?data.url?window.location=data.url:window.location.reload():(overlay.remove(),_Toast2.default.success(data.message),form.reset())}).onError(function(xhr){overlay.remove()})}},{key:"signup",value:function(e,show){var that=this;e.preventDefault();e.target;var loginForm=document.getElementById("login"),signupForm=document.getElementById("signup");show?(signupForm.show("flex"),loginForm.hide(),this.Captcha.render(signupForm.querySelector(".g-recaptcha"),{size:"invisible",callback:function(response){that.submitForm(null,signupForm)}})):(signupForm.hide(),loginForm.show("flex"))}}]),YBoard}();exports.default=new YBoard},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Modal=function(){function Modal(){_classCallCheck(this,Modal),this.modals=[]}return _createClass(Modal,[{key:"open",value:function(){function keyDownListener(e){27===e.keyCode&&that.closeLatest()}var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},that=this;this.modalRoot=document.getElementById("modal-root"),null===this.modalRoot&&(this.modalRoot=document.createElement("div"),this.modalRoot.id="modal-root",this.modalRoot.addEventListener("click",function(e){e.currentTarget===e.target&&that.closeLatest()}),document.addEventListener("keydown",keyDownListener),document.body.style.overflow="hidden",document.body.appendChild(this.modalRoot));var modal={};return modal.options=Object.assign({content:null,title:null,onOpen:null,onClose:null},options),modal.close=function(){"function"==typeof modal.options.onClose&&modal.options.onClose(this),modal.elm.remove(),null===that.modalRoot.querySelector(".modal")&&(document.removeEventListener("keydown",keyDownListener),that.modalRoot.remove(),document.body.style.overflow="")},modal.setTitle=function(title){modal.options.title=title,modal.titleTextElm.innerHTML=title},modal.elm=document.createElement("div"),modal.elm.classList.add("modal"),this.modalRoot.appendChild(modal.elm),modal.closeButton=document.createElement("button"),modal.closeButton.classList.add("close","icon-cross"),modal.closeButton.addEventListener("click",modal.close),null!==modal.options.title?(modal.titleElm=document.createElement("div"),modal.titleElm.classList.add("title"),modal.elm.appendChild(modal.titleElm),modal.titleTextElm=document.createElement("span"),modal.titleTextElm.innerHTML=modal.options.title,modal.titleElm.appendChild(modal.titleTextElm),modal.titleElm.appendChild(modal.closeButton)):modal.elm.appendChild(modal.closeButton),modal.content=document.createElement("div"),modal.content.classList.add("content"),modal.content.innerHTML=modal.options.content,modal.elm.appendChild(modal.content),"function"==typeof modal.options.onOpen&&modal.options.onOpen(modal),this.modals.push(modal),modal}},{key:"closeLatest",value:function(){var latest=this.modals.pop();void 0!==latest&&latest.close()}}]),Modal}();exports.default=new Modal},function(module,exports,__webpack_require__){"use strict";"function"!=typeof Element.prototype.remove&&(Element.prototype.remove=function(){this.parentElement.removeChild(this)}),"function"!=typeof NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),"function"!=typeof Element.prototype.matches&&(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.webkitMatchesSelector||function(selector){for(var element=this,elements=(element.document||element.ownerDocument).querySelectorAll(selector),index=0;elements[index]&&elements[index]!==element;)++index;return Boolean(elements[index])}),"function"!=typeof Element.prototype.closest&&(Element.prototype.closest=function(selector){for(var element=this;element&&1===element.nodeType;){if(element.matches(selector))return element;element=element.parentNode}return null})},function(module,exports,__webpack_require__){"use strict";Element.prototype.setAttributes=function(attributes){for(var key in attributes){if(!attributes.hasOwnProperty(key))return!0;this.setAttribute(key,attributes[key])}},Element.prototype.appendBefore=function(elm){elm.parentNode.insertBefore(this,elm)},Element.prototype.appendAfter=function(elm){elm.parentNode.insertBefore(this,elm.nextSibling)},Element.prototype.toggle=function(){"none"!==window.getComputedStyle(this).display?this.hide():this.show()},Element.prototype.hide=function(){this.style.display="none"},Element.prototype.show=function(){var style=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block";this.style.display=style},Element.prototype.insertAtCaret=function(before){var after=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(document.selection){var selection=document.selection.createRange();selection.text=before+selection.text+after,this.focus()}else if(this.selectionStart||0===this.selectionStart){var selectedText=this.value.substr(this.selectionStart,this.selectionEnd-this.selectionStart),startPos=this.selectionStart,endPos=this.selectionEnd;this.value=this.value.substr(0,startPos)+before+selectedText+after+this.value.substr(endPos,this.value.length),this.selectionStart=startPos+before.length,this.selectionEnd=startPos+before.length,this.focus()}else this.value+=before+after,this.focus()},NodeList.prototype.toggle=function(){this.forEach(function(elm){elm.toggle()})},NodeList.prototype.hide=function(){this.forEach(function(elm){elm.hide()})},NodeList.prototype.show=function(){this.forEach(function(elm){elm.show()})},NodeList.prototype.remove=function(){this.forEach(function(elm){elm.remove()})}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}__webpack_require__(4),__webpack_require__(5);var _YQuery2=_interopRequireDefault(__webpack_require__(0)),_YBoard2=_interopRequireDefault(__webpack_require__(2)),_Toast2=_interopRequireDefault(__webpack_require__(1)),_Modal2=_interopRequireDefault(__webpack_require__(3));_YQuery2.default.ajaxSetup({timeout:1e4,errorFunction:function(xhr){var errorMessage=xhr.responseText,errorTitle=messages.errorOccurred;if(0===xhr.responseText.length&&0===xhr.readyState&&0===xhr.status)errorMessage=messages.networkError;else if("timeout"===xhr.responseText)errorMessage=messages.timeoutWarning;else try{var text=JSON.parse(xhr.responseText);errorMessage=text.message,void 0!==text.title&&null!==text.title&&0!==text.title.length&&(errorTitle=text.title)}catch(e){errorMessage=xhr.responseText}418===xhr.status?_Toast2.default.error(errorMessage):_Toast2.default.error(errorMessage,errorTitle)},timeoutFunction:function(xhr){_Toast2.default.error(messages.timeoutWarning)}},{"X-CSRF-Token":"undefined"!=typeof csrfToken?csrfToken:null}),window.YBoard=_YBoard2.default,window.YQuery=_YQuery2.default,window.Toast=_Toast2.default,window.Modal=_Modal2.default},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Tooltip=function(){function Tooltip(e){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,Tooltip),this.options=Object.assign({openDelay:100,offset:10,content:"",onOpen:null,closeEvent:"mouseout",position:"bottom"},options),this.x=0,this.y=0,this.spaceAvailable={top:0,right:0,bottom:0,left:0},this.overflows=!1,this.event=e,this.id=0,this.open()}return _createClass(Tooltip,[{key:"open",value:function(){var that=this;this.elm=document.createElement("div"),this.elm.classList.add("tooltip"),null!==document.querySelector(".tooltip:last-of-type")&&(this.id=parseInt(document.querySelector(".tooltip:last-of-type").dataset.id)+1),this.elm.dataset.id=this.id,this.setContent(this.options.content),this.event.target.addEventListener(this.options.closeEvent,function(){that.close(that)}),0!==this.options.openDelay?setTimeout(function(){null!==that.elm&&(document.body.appendChild(that.elm),that.position())},this.options.openDelay):(document.body.appendChild(this.elm),this.position()),"function"==typeof this.options.onOpen&&this.options.onOpen(this)}},{key:"setContent",value:function(content){null!==this.elm&&(this.elm.innerHTML='<div class="tooltip-content">'+content+"</div>")}},{key:"close",value:function(tooltip){tooltip.elm=null;var tip=document.querySelector('.tooltip[data-id="'+tooltip.id+'"]');null!==tip&&tip.remove()}},{key:"position",value:function(){null!==this.elm&&(this.targetRect=this.event.target.getBoundingClientRect(),this.tipRect=this.elm.getBoundingClientRect(),this.spaceAvailable={top:this.targetRect.top,right:window.innerWidth-this.targetRect.right,bottom:window.innerHeight-this.targetRect.bottom,left:this.targetRect.left},this.calculatePosition(this.options.position),this.elm.classList.add(this.options.position),this.setPosition())}},{key:"calculatePosition",value:function(position){switch(this.options.position=position,position){case"top":case"bottom":this.x=this.targetRect.right-this.targetRect.width/2-this.tipRect.width/2,this.x<0&&(this.x=0);break;case"right":if(this.x=this.targetRect.right+this.options.offset,this.tipRect.width+this.options.offset>this.spaceAvailable.right){if(!(this.overflows||this.spaceAvailable.left<this.spaceAvailable.right))return this.recalculatePosition("left");this.elm.style.maxWidth=this.spaceAvailable.right-this.options.offset+"px",this.tipRect=this.elm.getBoundingClientRect()}break;case"left":if(this.x=this.targetRect.left-this.tipRect.width-this.options.offset,this.x<0){if(!(this.overflows||this.spaceAvailable.right<this.spaceAvailable.left))return this.recalculatePosition("right");this.elm.style.maxWidth=this.spaceAvailable.left-this.options.offset+"px",this.tipRect=this.elm.getBoundingClientRect()}}switch(position){case"top":if(this.y=this.targetRect.top-this.tipRect.height-this.options.offset,this.y<0){if(!(this.overflows||this.spaceAvailable.bottom<this.spaceAvailable.top))return this.recalculatePosition("bottom");this.y=0,this.elm.style.maxHeight=this.spaceAvailable.top-this.options.offset+"px",this.tipRect=this.elm.getBoundingClientRect()}break;case"bottom":if(this.y=this.targetRect.bottom+this.options.offset,this.tipRect.height+this.options.offset>this.spaceAvailable.bottom){if(!(this.overflows||this.spaceAvailable.top<this.spaceAvailable.bottom))return this.recalculatePosition("top");this.elm.style.maxHeight=this.spaceAvailable.bottom-this.options.offset+"px",this.tipRect=this.elm.getBoundingClientRect()}break;case"right":case"left":this.y=this.targetRect.bottom-this.targetRect.height/2-this.tipRect.height/2,this.y<0&&(this.y=0)}}},{key:"recalculatePosition",value:function(position){this.overflows=!0,this.calculatePosition(position)}},{key:"setPosition",value:function(){this.elm.style.left=window.scrollX+this.x+"px",this.elm.style.top=window.scrollY+this.y+"px"}}]),Tooltip}();exports.default=Tooltip},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Captcha=function(){function Captcha(){_classCallCheck(this,Captcha)}return _createClass(Captcha,[{key:"render",value:function(elm){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!(!this.isEnabled()||"undefined"==typeof grecaptcha||!elm||elm.dataset.rendered)&&(elm.dataset.rendered=!0,options=Object.assign({sitekey:config.reCaptchaPublicKey},options),grecaptcha.render(elm,options),!0)}},{key:"reset",value:function(){return!(!this.isEnabled()||"undefined"==typeof grecaptcha)&&(grecaptcha.reset(),!0)}},{key:"isEnabled",value:function(){return void 0!==config.reCaptchaPublicKey}}]),Captcha}();exports.default=Captcha},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),Catalog=function(){function Catalog(){_classCallCheck(this,Catalog);var searchInput=document.getElementById("search-catalog");searchInput&&searchInput.addEventListener("keyup",this.search)}return _createClass(Catalog,[{key:"search",value:function(e){var word=e.target.value,threads=document.querySelectorAll(".thread-box");0===word.length?threads.show():(threads.hide(),threads.forEach(function(elm){return-1!==elm.querySelector("h3").innerHTML.toLowerCase().indexOf(word.toLowerCase())?(elm.show(),!0):-1!==elm.querySelector(".post").innerHTML.toLowerCase().indexOf(word.toLowerCase())?(elm.show(),!0):void 0}))}}]),Catalog}();exports.default=Catalog},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_YQuery2=_interopRequireDefault(__webpack_require__(0)),_YBoard2=_interopRequireDefault(__webpack_require__(2)),_Toast2=_interopRequireDefault(__webpack_require__(1)),_File2=_interopRequireDefault(__webpack_require__(12)),Post=function(){function Post(){_classCallCheck(this,Post),this.File=new _File2.default(this)}return _createClass(Post,[{key:"bindEvents",value:function(elm){var that=this;this.File.bindEvents(elm),elm.querySelectorAll(".e-post-delete").forEach(function(elm){elm.addEventListener("click",that.delete)}),elm.querySelectorAll(".ref").forEach(function(elm){elm.addEventListener("click",that.refClick)})}},{key:"truncateLongPosts",value:function(elm){var that=this;elm.querySelectorAll(".message").forEach(function(elm){elm.dataset.height=elm.clientHeight}),elm.querySelectorAll(".message").forEach(function(elm){if(elm.dataset.height>600){elm.classList.add("truncated");var button=document.createElement("button");button.addEventListener("click",function(e){that.unTruncate(e.target.closest(".post").dataset.id)}),button.classList.add("button","e-untruncate"),button.innerHTML="Show full message",elm.parentNode.insertBefore(button,elm.nextSibling)}})}},{key:"unTruncate",value:function(id){var post=document.getElementById("post-"+id);if(console.log(id),console.log(post),null!==post){post.querySelector(".message").classList.remove("truncated");var button=post.querySelector(".e-untruncate");null!==button&&button.remove()}}},{key:"refClick",value:function(e){var referred=e.currentTarget.dataset.id;if(void 0===referred)return!0;null!==document.getElementById("post-"+referred)&&(e.preventDefault(),document.location.hash="#post-"+referred)}},{key:"getElm",value:function(id){return document.getElementById("post-"+id)}},{key:"delete",value:function(e){if(!confirm(messages.confirmDeletePost))return!1;var post=e.target.closest(".post"),id=post.dataset.id;_YQuery2.default.post("/api/post/delete",{postId:id}).onLoad(function(){post.remove(),document.body.classList.contains("thread-page")?null!==_YBoard2.default.Thread.getElm(id)&&_YBoard2.default.returnToBoard():(_YBoard2.default.Thread.getElm(id).remove(),_Toast2.default.success(messages.postDeleted))})}}]),Post}();exports.default=Post},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_YQuery2=_interopRequireDefault(__webpack_require__(0)),_YBoard2=_interopRequireDefault(__webpack_require__(2)),_Toast2=_interopRequireDefault(__webpack_require__(1)),PostForm=function(){function PostForm(){_classCallCheck(this,PostForm);var that=this;this.elm=document.getElementById("post-form"),null!==this.elm&&(this.captchaRendered=!1,this.locationParent=this.elm.parentNode,this.location=this.elm.nextElementSibling,this.msgElm=this.elm.querySelector("#post-message"),this.fileUploadInProgress=!1,this.fileUploadXhr=null,this.submitAfterFileUpload=!1,this.submitInProgress=!1,this.origDestName=!1,this.origDestValue=!1,this.elm.querySelectorAll(".bb-code").forEach(function(elm){elm.addEventListener("click",function(e){that.insertBbCode(e.target.dataset.code)})}),this.elm.querySelector(".e-postform-color-bar").addEventListener("click",function(){that.toggleBbColorBar()}),document.addEventListener("beforeunload",function(e){if(!that.submitInProgress&&null!==that.msgElm.offsetParent&&0!==that.msgElm.value.length)return messages.confirmUnload}),document.querySelectorAll(".create-thread").forEach(function(elm){elm.addEventListener("click",function(){that.show()})}),document.querySelectorAll(".e-thread-reply").forEach(function(elm){elm.addEventListener("click",function(e){e.preventDefault();var threadId=null,thread=e.target.closest(".thread");null!==thread&&(threadId=thread.dataset.id),that.threadReply(threadId)})}),this.elm.querySelector("#reset-button").addEventListener("click",function(e){e.preventDefault(),that.reset()}),this.elm.querySelector("#post-files").addEventListener("change",function(){that.uploadFile()}),this.elm.querySelector("#remove-file").addEventListener("click",function(){that.deleteUploadedFile(),that.removeFile()}),this.elm.querySelector(".toggle-options").addEventListener("click",function(e){e.preventDefault(),document.getElementById("post-options").toggle()}),this.elm.addEventListener("submit",function(e){that.submit(e)}),this.elm.querySelectorAll("input, select textarea").forEach(function(elm){elm.addEventListener("focus",function(e){that.renderCaptcha()})}))}return _createClass(PostForm,[{key:"bindPostEvents",value:function(elm){var that=this;elm.querySelectorAll(".e-post-reply").forEach(function(elm){elm.addEventListener("click",function(e){e.preventDefault(),that.postReply(e.target.closest(".post").dataset.id),that.msgElm.focus()})})}},{key:"show",value:function(isReply){isReply||this.reset(),this.renderCaptcha(),this.elm.classList.add("visible"),null!==this.msgElm.offsetParent&&this.msgElm.focus()}},{key:"renderCaptcha",value:function(){var that=this;if(_YBoard2.default.Captcha.isEnabled()){var button=this.elm.querySelector(".g-recaptcha");button&&!this.captchaRendered&&(this.captchaRendered=!0,_YBoard2.default.Captcha.render(button,{size:"invisible",callback:function(response){that.submit(null,response)}}))}}},{key:"hide",value:function(){this.elm.classList.remove("visible")}},{key:"reset",value:function(){this.elm.reset(),null!==this.location?this.locationParent.insertBefore(this.elm,this.location):this.locationParent.appendChild(this.elm),this.removeFile(),this.resetDestination(),this.hide()}},{key:"focus",value:function(){this.msgElm.focus()}},{key:"setDestination",value:function(isReply,destination){this.saveDestination();var name="board";isReply&&(name="thread");var postDestination=this.elm.querySelector("#post-destination");postDestination.setAttribute("name",name),postDestination.value=destination}},{key:"saveDestination",value:function(){var destElm=this.elm.querySelector("#post-destination"),boardSelector=this.elm.querySelector("#label-board");return null!==boardSelector?(boardSelector.hide(),boardSelector.querySelector("select").required=!1,!0):!!this.origDestName||(this.origDestName=destElm.getAttribute("name"),this.origDestValue=destElm.value,!0)}},{key:"resetDestination",value:function(){var destElm=this.elm.querySelector("#post-destination"),boardSelector=this.elm.querySelector("#label-board");return null!==boardSelector&&(boardSelector.show("flex"),boardSelector.querySelector("select").required=!0),!this.origDestName||(destElm.setAttribute("name",this.origDestName),destElm.value=this.origDestValue,this.origDestName=!1,this.origDestValue=!1,!0)}},{key:"insertBbCode",value:function(code){this.msgElm.insertAtCaret("["+code+"]","[/"+code+"]")}},{key:"toggleBbColorBar",value:function(){this.elm.querySelector("#color-buttons").toggle(),this.msgElm.focus()}},{key:"uploadFile",value:function(){this.elm.querySelector("#remove-file").show(),this.deleteUploadedFile(),this.removeFile(!0);var fileInput=this.elm.querySelector("#post-files"),fileNameElm=this.elm.querySelector("#file-name");fileNameElm.value="",this.submitAfterFileUpload=!1,this.updateFileProgressBar(1);for(var file,maxSize=fileInput.dataset.maxsize,fileList=fileInput.files,fileSizeSum=0,i=0;file=fileList[i];i++)fileSizeSum+=file.size;if(fileSizeSum>maxSize)return _Toast2.default.warning(messages.maxSizeExceeded),this.updateFileProgressBar(0),!1;var fd=new FormData;Array.from(fileList).forEach(function(file){fd.append("files[]",file)}),this.fileUploadInProgress=!0;var fileName=fileInput.value.split("\\").pop().split(".");fileName.pop(),fileNameElm.value=fileName.join(".");var that=this,fileUpload=_YQuery2.default.post("/api/file/create",fd,{timeout:0,contentType:null,xhr:function(_xhr){return _xhr.upload?(_xhr.upload.addEventListener("progress",function(e){if(e.lengthComputable){var percent=Math.round(e.loaded/e.total*100);percent<0?percent=0:percent>99&&(percent=99),that.updateFileProgressBar(percent)}}),_xhr):_xhr}}).onLoad(function(xhr){that.fileUploadInProgress=!1,that.updateFileProgressBar(100);var data=JSON.parse(xhr.responseText);0!==data.message.length?(that.elm.querySelector("#file-id").value=data.message[0],that.submitAfterFileUpload&&that.submit()):(_Toast2.default.error(messages.errorOccurred),that.removeFile(),that.updateFileProgressBar(0))}).onError(function(){that.removeFile(),that.updateFileProgressBar(0)});this.fileUploadXhr=fileUpload.getXhrObject()}},{key:"removeFile",value:function(){var refresh=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null!==this.fileUploadXhr&&(this.fileUploadXhr.abort(),this.fileUploadXhr=null),refresh||(this.elm.querySelector("#remove-file").hide(),this.elm.querySelector("#post-files").value=""),this.elm.querySelector("#file-id").value="",this.elm.querySelector("#file-name").value="",this.updateFileProgressBar(0),this.fileUploadInProgress=!1,this.submitAfterFileUpload=!1}},{key:"deleteUploadedFile",value:function(){var fileIdElm=this.elm.querySelector("#file-id");""!==fileIdElm.value&&_YQuery2.default.post("/api/file/delete",{fileId:fileIdElm.value})}},{key:"updateFileProgressBar",value:function(progress){progress<0?progress=0:progress>100&&(progress=100);var elm=this.elm.querySelector(".file-progress"),bar=elm.querySelector("div");0===progress?(bar.style.width=0,elm.classList.remove("in-progress")):(bar.style.width=progress+"%",elm.classList.add("in-progress"))}},{key:"threadReply",value:function(threadId){null!==threadId&&(_YBoard2.default.Thread.getElm(threadId).appendChild(this.elm),this.show(!0),this.setDestination(!0,threadId)),this.msgElm.focus()}},{key:"postReply",value:function(postId){var selectedText=_YBoard2.default.getSelectionText();_YBoard2.default.Post.getElm(postId).appendChild(this.elm),this.show(!0),this.setDestination(!0,this.elm.closest(".thread").dataset.id),this.msgElm.focus();var append="";"\n"===this.msgElm.value.substr(-1)?append+="\n":0!==this.msgElm.value.length&&(append+="\n\n"),append+=">>"+postId+"\n",""!==selectedText&&(append+=">"+selectedText.replace(/(\r\n|\n|\r)/g,"$1>")+"\n"),this.msgElm.value=this.msgElm.value.trim()+append}},{key:"submit",value:function(e){var that=this;"object"===(void 0===e?"undefined":_typeof(e))&&null!==e&&e.preventDefault();var submitButton=this.elm.querySelector('input[type="submit"].button');if(this.fileUploadInProgress)return _Toast2.default.info(messages.waitingForFileUpload),submitButton.disabled=!0,this.submitAfterFileUpload=!0,!1;if(this.submitInProgress)return!1;this.submitInProgress=!0,this.elm.querySelector("#post-files").value="";var fd=new FormData(this.elm);_YQuery2.default.post("/api/post/create",fd,{contentType:null}).onLoad(function(xhr){var dest=document.getElementById("post-destination"),thread=void 0;if(null!==(thread="thread"!==dest.getAttribute("name")?null:dest.value))_YBoard2.default.Thread.AutoUpdate.runOnce(thread),that.reset();else if(0===xhr.responseText.length)_YBoard2.default.pageReload();else{var data=JSON.parse(xhr.responseText);void 0===data.message?_Toast2.default.error(messages.errorOccurred):window.location="/"+fd.get("board")+"/"+data.message}}).onEnd(function(){submitButton.disabled=!1,that.submitInProgress=!1,_YBoard2.default.Captcha.reset()})}}]),PostForm}();exports.default=PostForm},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_YQuery2=_interopRequireDefault(__webpack_require__(0)),_YBoard2=_interopRequireDefault(__webpack_require__(2)),_Toast2=_interopRequireDefault(__webpack_require__(1)),File=function(){function File(Post){_classCallCheck(this,File),this.Post=Post}return _createClass(File,[{key:"bindEvents",value:function(parent){var that=this;parent.querySelectorAll(".thumbnail .image").forEach(function(elm){elm.addEventListener("click",function(e){that.expand(e,that)})}),parent.querySelectorAll(".thumbnail .media").forEach(function(elm){elm.addEventListener("click",function(e){that.playMedia(e,that)})}),parent.querySelectorAll(".e-stop-media").forEach(function(elm){elm.addEventListener("click",that.stopAllMedia)})}},{key:"delete",value:function(id){if(!confirm(messages.confirmDeleteFile))return!1;_YQuery2.default.post("/api/post/deletefile",{post_id:id,loadFunction:function(){this.getElm(id).find("figure").remove(),_Toast2.default.success(messages.fileDeleted)}})}},{key:"expand",value:function(e,that){function changeSrc(img,src){function expandOnLoad(e){e.target.removeEventListener("load",eolFn),delete e.target.dataset.expanding,clearTimeout(e.target.loading);var overlay=e.target.parentNode.querySelector("div.overlay");null!==overlay&&requestAnimationFrame(function(){overlay.remove()})}var eolFn=expandOnLoad;img.dataset.expanding=!0,img.loading=setTimeout(function(){var overlay=document.createElement("div");overlay.classList.add("overlay","center"),overlay.innerHTML=_YBoard2.default.spinnerHtml(),img.parentNode.appendChild(overlay)},200),img.addEventListener("load",eolFn),img.setAttribute("src",src)}e.preventDefault(),void 0===e.target.dataset.expanded?(e.target.dataset.expanded=e.target.getAttribute("src"),requestAnimationFrame(function(){changeSrc(e.target,e.target.parentNode.getAttribute("href")),e.target.closest(".post-file").classList.remove("thumbnail"),that.Post.unTruncate(e.target.closest(".post").dataset.id)})):requestAnimationFrame(function(){changeSrc(e.target,e.target.dataset.expanded),e.target.closest(".post-file").classList.add("thumbnail"),delete e.target.dataset.expanded;var elmTop=e.target.getBoundingClientRect().top+window.scrollY;elmTop<window.scrollY&&window.scrollTo(0,elmTop)})}},{key:"playMedia",value:function(e,that){e.preventDefault(),that.stopAllMedia();var fileId=e.target.closest("figure").dataset.id;if(void 0!==e.target.dataset.loading)return!1;e.target.dataset.loading=!0;var loading=setTimeout(function(){var overlay=document.createElement("div");overlay.classList.add("overlay","bottom","left"),overlay.innerHTML=_YBoard2.default.spinnerHtml(),requestAnimationFrame(function(){e.target.appendChild(overlay)})},200);_YQuery2.default.post("/api/file/getmediaplayer",{fileId:fileId}).onLoad(function(xhr){var figure=e.target.closest(".post-file"),message=e.target.closest(".message");that.Post.unTruncate(e.target.closest(".post").dataset.id),null!==message.nextElementSibling&&message.nextElementSibling.classList.contains("e-untruncate")&&message.nextElementSibling.remove();var data=document.createElement("div");data.innerHTML=xhr.responseText,_YBoard2.default.initElement(data);var video=figure.querySelector("video");if(null!==video){video.addEventListener("volumechange",function(e){localStorage.setItem("videoVolume",e.target.volume)});var volume=localStorage.getItem("videoVolume");null!==volume&&(video.volume=volume)}requestAnimationFrame(function(){figure.classList.remove("thumbnail"),figure.classList.add("media-player-container"),figure.insertBefore(data,figure.firstElementChild)})}).onEnd(function(){clearTimeout(loading),e.target.querySelectorAll("div.overlay").forEach(function(elm){requestAnimationFrame(function(){elm.remove()})}),delete e.target.dataset.loading})}},{key:"stopAllMedia",value:function(){document.querySelectorAll(".media-player-container").forEach(function(elm){var video=elm.querySelector("video");video.pause(),video.remove(),requestAnimationFrame(function(){elm.classList.remove("media-player-container"),elm.classList.add("thumbnail")})})}}]),File}();exports.default=File},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_YQuery2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(0)),Theme=function(){function Theme(){_classCallCheck(this,Theme);var that=this;document.querySelector(".e-switch-theme").addEventListener("click",function(){that.switchVariation()}),document.getElementById("sidebar").addEventListener("click",function(e){e.offsetX>document.getElementById("sidebar").clientWidth&&document.body.classList.toggle("sidebar-visible")}),document.querySelector("#e-sidebar-toggle").addEventListener("click",function(){document.body.classList.toggle("sidebar-visible")})}return _createClass(Theme,[{key:"toggleSidebar",value:function(){document.body.classList.toggle("no-sidebar"),_YQuery2.default.post("/api/user/preferences/set",{hideSidebar:document.body.classList.contains("no-sidebar")})}},{key:"switchVariation",value:function(){var css=document.querySelectorAll("head .css"),light=(css=css[css.length-1]).dataset.light,dark=css.dataset.dark,newVariation=void 0,darkTheme=void 0;"true"===css.dataset.darktheme?(newVariation=light,darkTheme=!1):(newVariation=dark,darkTheme=!0);var newCss=css.cloneNode();newCss.setAttributes({href:newVariation,"data-darkTheme":darkTheme}),newCss.appendAfter(css);setTimeout(function(){css.remove()},5e3);_YQuery2.default.post("/api/user/preferences/set",{darkTheme:darkTheme})}}]),Theme}();exports.default=Theme},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_YQuery2=_interopRequireDefault(__webpack_require__(0)),_YBoard2=_interopRequireDefault(__webpack_require__(2)),_AutoUpdate2=_interopRequireDefault(__webpack_require__(15)),_Hide2=_interopRequireDefault(__webpack_require__(17)),_Follow2=_interopRequireDefault(__webpack_require__(16)),Thread=function(){function Thread(){_classCallCheck(this,Thread);var that=this;this.AutoUpdate=new _AutoUpdate2.default,this.Hide=new _Hide2.default,this.Follow=new _Follow2.default,document.querySelectorAll(".replies-buttons").forEach(function(elm){elm.querySelector(".e-more-replies").addEventListener("click",that.expand),elm.querySelector(".e-less-replies").addEventListener("click",that.shrink)})}return _createClass(Thread,[{key:"getElm",value:function(id){return document.getElementById("thread-"+id)}},{key:"toggleLock",value:function(id){0==this.getElm(id).find("h3 a .icon-lock").length?$.post("/scripts/threads/lock",{threadId:id}).done(function(){YB.thread.getElm(id).find("h3 a").prepend('<span class="icon-lock icon"></span>'),toastr.success(messages.threadLocked)}):$.post("/scripts/threads/unlock",{threadId:id}).done(function(){YB.thread.getElm(id).find("h3 a .icon-lock").remove(),toastr.success(messages.threadUnlocked)})}},{key:"toggleSticky",value:function(id){0==this.getElm(id).find("h3 a .icon-lock").length?$.post("/scripts/threads/stick",{threadId:id}).done(function(){YB.thread.getElm(id).find("h3 a").prepend('<span class="icon-pushpin icon"></span>'),toastr.success(messages.threadStickied)}):$.post("/scripts/threads/unstick",{threadId:id}).done(function(){YB.thread.getElm(id).find("h3 a .icon-pushpin").remove(),toastr.success(messages.threadUnstickied)})}},{key:"shrink",value:function(e){var thread=e.target.closest(".thread");thread.querySelector(".more-replies-container").innerHTML="",thread.querySelector(".e-more-replies").show(),thread.classList.remove("expanded")}},{key:"expand",value:function(e){var thread=e.target.closest(".thread"),threadId=thread.dataset.id,fromId=thread.querySelector(".reply").dataset.id;_YQuery2.default.post("/api/thread/getreplies",{threadId:threadId,fromId:fromId,count:100}).onLoad(function(xhr){var data=document.createElement("div");data.innerHTML=xhr.responseText,data.querySelectorAll(".post").length<100&&thread.querySelector(".e-more-replies").hide();var expandContainer=thread.querySelector(".more-replies-container"),firstVisibleReply=expandContainer.querySelector(".reply");null===firstVisibleReply?expandContainer.appendChild(data):thread.querySelector(".more-replies-container").insertBefore(data,firstVisibleReply),_YBoard2.default.initElement(data),thread.classList.add("expanded")})}}]),Thread}();exports.default=Thread},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_YBoard2=_interopRequireDefault(__webpack_require__(2)),_YQuery2=_interopRequireDefault(__webpack_require__(0)),_Toast2=_interopRequireDefault(__webpack_require__(1)),AutoUpdate=function(){function AutoUpdate(){_classCallCheck(this,AutoUpdate);var that=this;this.threadId=!1,this.nextLoadDelay=2e3,this.newReplies=0,this.lastUpdateNewReplies=0,this.runCount=0,this.nowLoading=!1,this.isActive=!1,this.nextRunTimeout=0,this.startDelayTimeout=0,this.originalDocTitle=document.title,document.querySelectorAll(".thread .e-get-replies").forEach(function(elm){elm.addEventListener("click",function(e){e.preventDefault(),that.runOnce(elm.closest(".thread").dataset.id)})})}return _createClass(AutoUpdate,[{key:"run",value:function(manual){if(this.nowLoading)return!1;this.nextLoadDelay=this.nextLoadDelay*(0===this.runCount?1:this.runCount),this.nextLoadDelay>3e4&&(this.nextLoadDelay=3e4),this.runCount>40&&this.stop(),manual&&(this.runCount=0,this.isActive&&this.restart());var thread=_YBoard2.default.Thread.getElm(this.threadId),fromId=thread.querySelector(".reply:last-of-type");fromId=null===fromId?0:fromId.getAttribute("id").replace("post-",""),this.nowLoading=!0;var that=this;_YQuery2.default.post("/api/thread/getreplies",{threadId:this.threadId,fromId:fromId,newest:!0,xhr:function(_xhr){return _xhr.responseType="document",_xhr}}).onLoad(function(xhr){if(manual&&0===xhr.responseText.length)return void _Toast2.default.info(messages.noNewReplies);var data=document.createElement("div");data.innerHTML=xhr.responseText,that.lastUpdateNewReplies=data.querySelectorAll(".post").length,that.newReplies+=that.lastUpdateNewReplies,0===that.lastUpdateNewReplies?++that.runCount:that.runCount=0,_YBoard2.default.initElement(data),requestAnimationFrame(function(){thread.querySelector(".replies").appendChild(data)}),manual||(that.nextRunTimeout=setTimeout(function(){that.start()},that.nextLoadDelay))}).onError(function(){that.stop()}).onEnd(function(){if(that.nowLoading=!1,!document.hasFocus()&&that.newReplies>0&&document.body.classList.contains("thread-page")){document.title="("+that.newReplies+") "+that.originalDocTitle;var replies=document.querySelector(".replies");replies.querySelector("hr").remove();var hr=document.createElement("hr");replies.insertBefore(hr,replies.querySelector(".reply:eq(-"+that.newReplies+")"))}else 0!==that.newReplies&&(that.newReplies=0)})}},{key:"runOnce",value:function(thread){this.threadId=thread,this.run(!0)}},{key:"start",value:function(){this.isActive=!0,this.startDelayTimeout&&clearTimeout(this.startDelayTimeout);var that=this;return this.threadId=$(".thread:first").data("id"),this.startDelayTimeout=setTimeout(function(){that.run(!1)},1e3),!0}},{key:"stop",value:function(){return!this.isActive||(this.startDelayTimeout&&clearTimeout(this.startDelayTimeout),this.isActive=!1,this.reset(),!0)}},{key:"restart",value:function(){this.stop(),this.start()}},{key:"reset",value:function(){this.nowLoading=!1,this.newReplies=0,this.runCount=0,document.title!==this.originalDocTitle&&(document.title=this.originalDocTitle),this.nextRunTimeout&&clearTimeout(this.nextRunTimeout)}}]),AutoUpdate}();exports.default=AutoUpdate},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_YQuery2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(0)),Follow=function(){function Follow(){_classCallCheck(this,Follow);var that=this;document.querySelectorAll(".e-thread-follow").forEach(function(elm){elm.addEventListener("click",that.toggle)}),document.querySelectorAll(".e-follow-mark-read").forEach(function(elm){elm.addEventListener("click",that.markAllRead)})}return _createClass(Follow,[{key:"markAllRead",value:function(){document.querySelectorAll(".icon-bookmark .unread-count").forEach(function(elm){elm.hide()}),document.querySelectorAll("h3 .notification-count").forEach(function(elm){elm.hide()}),_YQuery2.default.post("/api/user/thread/follow/markallread").onError(function(){document.querySelectorAll(".icon-bookmark .unread-count").forEach(function(elm){elm.show()}),document.querySelectorAll("h3 .notification-count").forEach(function(elm){elm.show()})})}},{key:"toggle",value:function(e){function toggleButton(elm){elm.classList.contains("act")?(elm.classList.add("icon-bookmark-add"),elm.classList.remove("icon-bookmark-remove","act")):(elm.classList.add("icon-bookmark-remove","act"),elm.classList.remove("icon-bookmark-add"))}var thread=e.target.closest(".thread"),button=e.currentTarget,create=!0;e.currentTarget.classList.contains("act")&&(create=!1),thread.classList.toggle("followed"),toggleButton(button),_YQuery2.default.post(create?"/api/user/thread/follow/create":"/api/user/thread/follow/delete",{threadId:thread.dataset.id}).onError(function(xhr){thread.classList.toggle("followed"),toggleButton(button)})}}]),Follow}();exports.default=Follow},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_YQuery2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(0)),Hide=function(){function Hide(){_classCallCheck(this,Hide);var that=this;document.querySelectorAll(".e-thread-hide").forEach(function(elm){elm.addEventListener("click",that.toggle)})}return _createClass(Hide,[{key:"toggle",value:function(e){function toggleButton(elm){elm.classList.contains("act")?(elm.classList.add("icon-eye-crossed"),elm.classList.remove("icon-eye","act")):(elm.classList.add("icon-eye","act"),elm.classList.remove("icon-eye-crossed"))}var thread=e.target.closest(".thread"),button=e.currentTarget,create=!0;e.currentTarget.classList.contains("act")&&(create=!1),thread.classList.toggle("hidden"),toggleButton(button),_YQuery2.default.post(create?"/api/user/thread/hide/create":"/api/user/thread/hide/delete",{threadId:thread.dataset.id}).onError(function(xhr){thread.classList.toggle("hidden"),toggleButton(button)})}}]),Hide}();exports.default=Hide}]);
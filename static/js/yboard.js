!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){o(this,e),this.ajaxOptions={method:"GET",url:"",data:null,timeout:3e4,loadFunction:null,timeoutFunction:null,errorFunction:null,loadendFunction:null,cache:!1,contentType:null,xhr:null},this.ajaxHeaders={"X-Requested-With":"XMLHttpRequest"}}return i(e,[{key:"on",value:function(e,t,n){return document.addEventListener(e,function(e){t&&!e.target.matches(t)||n(e)}),this}},{key:"ajaxSetup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.ajaxOptions=Object.assign(this.ajaxOptions,e),this.ajaxHeaders=Object.assign(this.ajaxHeaders,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=Object.assign({url:e},t),n=Object.assign({},this.ajaxHeaders,n),this.ajax(t,n)}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n=Object.assign({method:"POST",url:e,data:t},n),o=Object.assign({},this.ajaxHeaders,o),this.ajax(n,o)}},{key:"ajax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=Object.assign({},this.ajaxOptions,e),e.cache||(t=Object.assign(t,{"Cache-Control":"no-cache, max-age=0"}));var n=new XMLHttpRequest;n.timeout=e.timeout,n.open(e.method,e.url);for(var o in t)t.hasOwnProperty(o)&&n.setRequestHeader(o,t[o]);if(this.onLoad=function(e){return n.addEventListener("load",function(){200===n.status&&e(n)}),this},"function"==typeof e.loadFunction&&this.onLoad(e.loadFunction),this.onTimeout=function(e){return n.addEventListener("timeout",function(){e(n)}),this},"function"==typeof e.timeoutFunction&&this.onTimeout(e.timeoutFunction),this.onError=function(e){return n.addEventListener("loadend",function(){200!==n.status&&0!==n.status&&e(n)}),this},"function"==typeof e.errorFunction&&this.onError(e.errorFunction),this.onEnd=function(e){return n.addEventListener("loadend",function(){e(n)}),this},"function"==typeof e.loadendFunction&&this.onEnd(e.loadendFunction),this.getXhrObject=function(){return n},"function"==typeof e.xhr&&(n=e.xhr(n)),"function"!=typeof e.data.append){var i=new FormData;Object.keys(e.data).forEach(function(t){return i.append(t,e.data[t])}),e.data=i}return n.send(e.data),this}},{key:"benchmark",value:function(e,t){void 0===t&&(t=1e5);for(var n=t,o=new Date;t--;)e();var i=new Date-o,r=i/n,a=(1e3/r).toFixed(2);return i+" ms, "+r.toFixed(2)+" ms per op, "+a+" ops/sec"}}]),e}();t.default=new r},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(0),l=o(s),u=n(9),c=o(u),d=n(15),f=o(d),h=n(10),m=o(h),p=n(16),v=o(p),y=n(12),g=o(y),b=n(13),E=o(b),w=n(11),k=(o(w),n(8)),L=o(k),T=n(2),S=o(T),x=function(){function e(){i(this,e);var t=this;this.Catalog=new m.default,this.Captcha=new c.default,this.Theme=new f.default,this.Thread=new v.default,this.Post=new g.default,this.PostForm=new E.default,this.isBadBrowser()&&this.browserWarning(),document.addEventListener("keydown",function(e){(!e.ctrlKey&&!e.shiftKey&&116===e.which||e.ctrlKey&&!e.shiftKey&&82===e.which)&&(e.preventDefault(),t.pageReload()),e.ctrlKey&&13===e.which&&t.PostForm.submit(e)}),l.default.on("submit","form.ajax",function(e){t.submitForm(e)});var n=document.getElementById("login");null!==n&&(n.querySelector(".signup").addEventListener("click",function(e){t.signup(e,!0)}),document.getElementById("signup").querySelector(".cancel").addEventListener("click",function(e){t.signup(e,!1)})),document.getElementById("sidebar-hide-button").addEventListener("click",function(){t.Theme.toggleSidebar()}),document.getElementById("scroll-to-top").addEventListener("click",function(){window.scrollTo(0,0)}),document.getElementById("scroll-to-bottom").addEventListener("click",function(){window.scrollTo(0,document.body.scrollHeight)}),document.getElementById("reload-page").addEventListener("click",function(){t.pageReload()}),this.initElement(document)}return a(e,[{key:"initElement",value:function(e){var t=this,n=void 0;"function"==typeof e.getElementsByClassName?([].forEach.call(e.getElementsByClassName("datetime"),this.localizeDatetime),[].forEach.call(e.getElementsByClassName("number"),this.localizeNumber),[].forEach.call(e.getElementsByClassName("currency"),this.localizeCurrency),n=Array.prototype.concat.apply([],e.getElementsByClassName("tip")),n=Array.prototype.concat.apply(n,e.getElementsByClassName("ref"))):(e.querySelectorAll(".datetime").forEach(this.localizeDatetime),e.querySelectorAll(".number").forEach(this.localizeNumber),e.querySelectorAll(".currency").forEach(this.localizeCurrency),n=e.querySelectorAll(".tip, .ref")),this.Post.bindEvents(e),n.forEach(function(e){e.addEventListener("mouseover",function(e){var n=null;void 0!==e.target.dataset.id&&(n=e.target.dataset.id),new L.default(e,{openDelay:100,position:"bottom",content:t.spinnerHtml(),onOpen:function(e){l.default.post("/api/post/get",{postId:n}).onLoad(function(t){e.setContent(t.responseText),e.position()}).onError(function(t){e.setContent(messages.errorOccurred),e.position()})}})})})}},{key:"localizeDatetime",value:function(e){e.innerHTML=new Date(e.innerHTML.replace(" ","T")+"Z").toLocaleString("ca")}},{key:"localizeNumber",value:function(e){e.innerHTML=parseFloat(e.innerHTML).toLocaleString("nu",{minimumFractionDigits:0})}},{key:"localizeCurrency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"eur";0===t&&(t="eur"),e.innerHTML=parseFloat(e.innerHTML).toLocaleString("nu",{style:"currency",currency:t})}},{key:"getSelectionText",value:function(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(e=document.selection.createRange().text),e}},{key:"isBadBrowser",value:function(){return"function"!=typeof FormData||"object"!==("undefined"==typeof localStorage?"undefined":r(localStorage))}},{key:"browserWarning",value:function(){var e=document.createElement("div");e.classList.add("old-browser-warning"),e.innerHTML="<p>"+messages.oldBrowserWarning+"</p>",document.body.appendChild(e)}},{key:"pageReload",value:function(){window.location=window.location.href.split("#")[0]}},{key:"returnToBoard",value:function(){var e=window.location.href;e=e.substr(0,e.lastIndexOf("/")+1),window.location=e}},{key:"spinnerHtml",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return""!==e&&(e+=" "),'<span class="'+e+'loading icon-loading spin"></span>'}},{key:"submitForm",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!==e&&(e.preventDefault(),t=e.target),!1===t)return!1;var n=new FormData(t),o=document.createElement("div");o.classList.add("form-overlay"),o.innerHTML="<div>"+this.spinnerHtml()+"</div></div>",t.appendChild(o),l.default.post(t.getAttribute("action"),n).onLoad(function(e){var n=JSON.parse(e.responseText);n.reload?n.url?window.location=n.url:window.location.reload():(o.remove(),S.default.success(n.message),t.reset())}).onError(function(e){o.remove()})}},{key:"signup",value:function(e,t){var n=this;e.preventDefault();var o=(e.target,document.getElementById("login")),i=document.getElementById("signup");t?(i.show("flex"),o.hide(),this.Captcha.render(i.querySelector(".g-recaptcha"),{size:"invisible",callback:function(e){n.submitForm(null,i)}})):(i.hide(),o.show("flex"))}}]),e}();t.default=new x},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.options=Object.assign({displayTime:3e3,fadeTime:2e3},t)}return i(e,[{key:"success",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._show("success",e,t,n)}},{key:"info",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._show("info",e,t,n)}},{key:"warning",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._show("warning",e,t,n)}},{key:"error",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._show("error",e,t,n)}},{key:"_show",value:function(e,t,n,o){var i=this;o=Object.assign({},this.options,o);var r=document.getElementById("toast-root");null===r&&(r=document.createElement("div"),r.id="toast-root",document.body.appendChild(r));var a=document.createElement("div");a.classList.add("toast",e);var s=document.createElement("div");if(s.classList.add("toast-content"),a.appendChild(s),!1!==n){var l=document.createElement("h3");l.innerHTML=n,s.appendChild(l)}var u=document.createElement("p");u.innerHTML=t,s.appendChild(u),r.appendChild(a),a.addEventListener("click",function(e){e.currentTarget.removeToast()}),a.removeToast=function(){a.remove(),null===r.querySelector(".toast")&&r.remove()},a.startFade=function(){a.classList.add("fading"),a.style.transitionDuration=i.options.fadeTime/1e3+"s"};var c=void 0,d=void 0;c=setTimeout(a.startFade,o.displayTime),d=setTimeout(a.removeToast,o.displayTime+o.fadeTime),a.addEventListener("mouseover",function(e){clearTimeout(c),clearTimeout(d),e.currentTarget.classList.remove("fading"),e.currentTarget.style.transitionDuration=""}),a.addEventListener("mouseout",function(e){c=setTimeout(a.startFade,o.displayTime),d=setTimeout(a.removeToast,o.displayTime+o.fadeTime)})}}]),e}();t.default=new r},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var i=n(0),r=(o(i),n(1));o(r)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){o(this,e),this.modals=[]}return i(e,[{key:"open",value:function(){function e(e){27===e.keyCode&&n.closeLatest()}var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this;this.modalRoot=document.getElementById("modal-root"),null===this.modalRoot&&(this.modalRoot=document.createElement("div"),this.modalRoot.id="modal-root",this.modalRoot.addEventListener("click",function(e){e.currentTarget===e.target&&n.closeLatest()}),document.addEventListener("keydown",e),document.body.style.overflow="hidden",document.body.appendChild(this.modalRoot));var o={};return o.options=Object.assign({content:null,title:null,onOpen:null,onClose:null},t),o.close=function(){"function"==typeof o.options.onClose&&o.options.onClose(this),o.elm.remove(),null===n.modalRoot.querySelector(".modal")&&(document.removeEventListener("keydown",e),n.modalRoot.remove(),document.body.style.overflow="")},o.setTitle=function(e){o.options.title=e,o.titleTextElm.innerHTML=e},o.elm=document.createElement("div"),o.elm.classList.add("modal"),this.modalRoot.appendChild(o.elm),o.closeButton=document.createElement("button"),o.closeButton.classList.add("close","icon-cross"),o.closeButton.addEventListener("click",o.close),null!==o.options.title?(o.titleElm=document.createElement("div"),o.titleElm.classList.add("title"),o.elm.appendChild(o.titleElm),o.titleTextElm=document.createElement("span"),o.titleTextElm.innerHTML=o.options.title,o.titleElm.appendChild(o.titleTextElm),o.titleElm.appendChild(o.closeButton)):o.elm.appendChild(o.closeButton),o.content=document.createElement("div"),o.content.classList.add("content"),o.content.innerHTML=o.options.content,o.elm.appendChild(o.content),"function"==typeof o.options.onOpen&&o.options.onOpen(o),this.modals.push(o),o}},{key:"closeLatest",value:function(){var e=this.modals.pop();void 0!==e&&e.close()}}]),e}();t.default=new r},function(e,t,n){"use strict";"function"!=typeof Element.prototype.remove&&(Element.prototype.remove=function(){this.parentElement.removeChild(this)}),"function"!=typeof NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),"function"!=typeof Element.prototype.matches&&(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=this,n=(t.document||t.ownerDocument).querySelectorAll(e),o=0;n[o]&&n[o]!==t;)++o;return Boolean(n[o])}),"function"!=typeof Element.prototype.closest&&(Element.prototype.closest=function(e){for(var t=this;t&&1===t.nodeType;){if(t.matches(e))return t;t=t.parentNode}return null})},function(e,t,n){"use strict";Element.prototype.setAttributes=function(e){for(var t in e){if(!e.hasOwnProperty(t))return!0;this.setAttribute(t,e[t])}},Element.prototype.appendBefore=function(e){e.parentNode.insertBefore(this,e)},Element.prototype.appendAfter=function(e){e.parentNode.insertBefore(this,e.nextSibling)},Element.prototype.toggle=function(){"none"!==window.getComputedStyle(this).display?this.hide():this.show()},Element.prototype.hide=function(){this.style.display="none"},Element.prototype.show=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block";this.style.display=e},Element.prototype.insertAtCaret=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(document.selection){var n=document.selection.createRange();n.text=e+n.text+t,this.focus()}else if(this.selectionStart||0===this.selectionStart){var o=this.value.substr(this.selectionStart,this.selectionEnd-this.selectionStart),i=this.selectionStart,r=this.selectionEnd;this.value=this.value.substr(0,i)+e+o+t+this.value.substr(r,this.value.length),this.selectionStart=i+e.length,this.selectionEnd=i+e.length,this.focus()}else this.value+=e+t,this.focus()},NodeList.prototype.toggle=function(){this.forEach(function(e){e.toggle()})},NodeList.prototype.hide=function(){this.forEach(function(e){e.hide()})},NodeList.prototype.show=function(){this.forEach(function(e){e.show()})},NodeList.prototype.remove=function(){this.forEach(function(e){e.remove()})}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}n(5),n(6),n(3);var i=n(0),r=o(i),a=n(1),s=o(a),l=n(2),u=o(l),c=n(4),d=o(c);r.default.ajaxSetup({timeout:1e4,errorFunction:function(e){var t=e.responseText,n=messages.errorOccurred;if(0===e.responseText.length&&0===e.readyState&&0===e.status)t=messages.networkError;else if("timeout"===e.responseText)t=messages.timeoutWarning;else try{var o=JSON.parse(e.responseText);t=o.message,void 0!==o.title&&null!==o.title&&0!==o.title.length&&(n=o.title)}catch(n){t=e.responseText}418===e.status?u.default.error(t):u.default.error(t,n)},timeoutFunction:function(e){u.default.error(messages.timeoutWarning)}},{"X-CSRF-Token":"undefined"!=typeof csrfToken?csrfToken:null}),window.YBoard=s.default,window.YQuery=r.default,window.Toast=u.default,window.Modal=d.default},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,e),this.options=Object.assign({openDelay:100,offset:10,content:"",onOpen:null,closeEvent:"mouseout",position:"bottom"},n),this.x=0,this.y=0,this.spaceAvailable={top:0,right:0,bottom:0,left:0},this.overflows=!1,this.event=t,this.id=0,this.open()}return i(e,[{key:"open",value:function(){var e=this;this.elm=document.createElement("div"),this.elm.classList.add("tooltip"),null!==document.querySelector(".tooltip:last-of-type")&&(this.id=parseInt(document.querySelector(".tooltip:last-of-type").dataset.id)+1),this.elm.dataset.id=this.id,this.setContent(this.options.content),this.event.target.addEventListener(this.options.closeEvent,function(){e.close(e)}),0!==this.options.openDelay?setTimeout(function(){null!==e.elm&&(document.body.appendChild(e.elm),e.position())},this.options.openDelay):(document.body.appendChild(this.elm),this.position()),"function"==typeof this.options.onOpen&&this.options.onOpen(this)}},{key:"setContent",value:function(e){null!==this.elm&&(this.elm.innerHTML='<div class="tooltip-content">'+e+"</div>")}},{key:"close",value:function(e){e.elm=null;var t=document.querySelector('.tooltip[data-id="'+e.id+'"]');null!==t&&t.remove()}},{key:"position",value:function(){null!==this.elm&&(this.targetRect=this.event.target.getBoundingClientRect(),this.tipRect=this.elm.getBoundingClientRect(),this.spaceAvailable={top:this.targetRect.top,right:window.innerWidth-this.targetRect.right,bottom:window.innerHeight-this.targetRect.bottom,left:this.targetRect.left},this.calculatePosition(this.options.position),this.elm.classList.add(this.options.position),this.setPosition())}},{key:"calculatePosition",value:function(e){switch(this.options.position=e,e){case"top":case"bottom":this.x=this.targetRect.right-this.targetRect.width/2-this.tipRect.width/2,this.x<0&&(this.x=0);break;case"right":if(this.x=this.targetRect.right+this.options.offset,this.tipRect.width+this.options.offset>this.spaceAvailable.right){if(!(this.overflows||this.spaceAvailable.left<this.spaceAvailable.right))return this.recalculatePosition("left");this.elm.style.maxWidth=this.spaceAvailable.right-this.options.offset+"px",this.tipRect=this.elm.getBoundingClientRect()}break;case"left":if(this.x=this.targetRect.left-this.tipRect.width-this.options.offset,this.x<0){if(!(this.overflows||this.spaceAvailable.right<this.spaceAvailable.left))return this.recalculatePosition("right");this.elm.style.maxWidth=this.spaceAvailable.left-this.options.offset+"px",this.tipRect=this.elm.getBoundingClientRect()}}switch(e){case"top":if(this.y=this.targetRect.top-this.tipRect.height-this.options.offset,this.y<0){if(!(this.overflows||this.spaceAvailable.bottom<this.spaceAvailable.top))return this.recalculatePosition("bottom");this.y=0,this.elm.style.maxHeight=this.spaceAvailable.top-this.options.offset+"px",this.tipRect=this.elm.getBoundingClientRect()}break;case"bottom":if(this.y=this.targetRect.bottom+this.options.offset,this.tipRect.height+this.options.offset>this.spaceAvailable.bottom){if(!(this.overflows||this.spaceAvailable.top<this.spaceAvailable.bottom))return this.recalculatePosition("top");this.elm.style.maxHeight=this.spaceAvailable.bottom-this.options.offset+"px",this.tipRect=this.elm.getBoundingClientRect()}break;case"right":case"left":this.y=this.targetRect.bottom-this.targetRect.height/2-this.tipRect.height/2,this.y<0&&(this.y=0)}}},{key:"recalculatePosition",value:function(e){this.overflows=!0,this.calculatePosition(e)}},{key:"setPosition",value:function(){this.elm.style.left=window.scrollX+this.x+"px",this.elm.style.top=window.scrollY+this.y+"px"}}]),e}();t.default=r},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){o(this,e)}return i(e,[{key:"render",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!(!this.isEnabled()||"undefined"==typeof grecaptcha||!e||e.dataset.rendered)&&(e.dataset.rendered=!0,t=Object.assign({sitekey:config.reCaptchaPublicKey},t),grecaptcha.render(e,t),!0)}},{key:"reset",value:function(){return!(!this.isEnabled()||"undefined"==typeof grecaptcha)&&(grecaptcha.reset(),!0)}},{key:"isEnabled",value:function(){return void 0!==config.reCaptchaPublicKey}}]),e}();t.default=r},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){o(this,e);var t=document.getElementById("search-catalog");t&&t.addEventListener("keyup",this.search)}return i(e,[{key:"search",value:function(e){var t=e.target,n=t.value,o=document.querySelectorAll(".thread-box");0===n.length?o.show():(o.hide(),o.forEach(function(e){return-1!==e.querySelector("h3").innerHTML.toLowerCase().indexOf(n.toLowerCase())?(e.show(),!0):-1!==e.querySelector(".post").innerHTML.toLowerCase().indexOf(n.toLowerCase())?(e.show(),!0):void 0}))}}]),e}();t.default=r},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){o(this,e)}return i(e,[{key:"open",value:function(e,t){var n=this;this.$body=$("body"),this.$blocker=null,this.options=$.extend({closeExisting:!0,postData:{},onAjaxComplete:function(){}},t),this.options.closeExisting&&$(".modal-container").remove(),this.$body.css("overflow","hidden"),$(".modal-container.current").removeClass("current"),this.$blocker=$('<div class="modal-container current"></div>').appendTo(this.$body),$(document).off("keydown.modal").on("keydown.modal",function(e){27==e.which&&n.close()}),this.$blocker.click(function(e){e.target==this&&n.close()}),this.$container=$('<div class="modal"><button class="modal-close"><span class="icon-cross"></span></button></div>'),this.$blocker.append(this.$container),this.$elm=$('<div class="modal-content"></div>'),this.$container.append(this.$elm),this.$elm.html('<div class="modal-loading">'+YB.spinnerHtml()+"</div>");var o=this.$elm;$.ajax({url:e,type:"POST",data:t.postData}).done(function(e){o.html(e)}).fail(function(){YB.modal.close()})}},{key:"close",value:function(){$(".modal-container:last").remove(),$(".modal-container:last").addClass("current"),0==$(".modal-container").length&&$("body").css("overflow","")}},{key:"closeAll",value:function(){$(".modal-container").remove(),$("body").css("overflow","")}},{key:"bindClose",value:function(){var e=this;document.querySelectorAll(".modal-close").forEach(function(t){t.removeEventListener("click",e.close),t.addEventListener("click",e.close)})}}]),e}();t.default=r},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),s=o(a),l=n(1),u=o(l),c=n(2),d=o(c),f=n(14),h=o(f),m=function(){function e(){i(this,e);var t=this;this.File=new h.default,document.addEventListener("hashchange",function(){t.removeHighlights()})}return r(e,[{key:"bindEvents",value:function(e){var t=this;this.File.bindEvents(e),e.querySelectorAll(".e-post-delete").forEach(function(e){e.addEventListener("click",t.delete)})}},{key:"getElm",value:function(e){return document.getElementById("post-"+e)}},{key:"delete",value:function(e){if(!confirm(messages.confirmDeletePost))return!1;var t=e.target.closest(".post"),n=t.dataset.id;s.default.post("/api/post/delete",{postId:n}).onLoad(function(){t.remove(),document.body.classList.contains("thread-page")?null!==u.default.Thread.getElm(n)&&u.default.returnToBoard():(u.default.Thread.getElm(n).remove(),d.default.success(messages.postDeleted))})}},{key:"highlight",value:function(e){this.getElm(e).classList.add("highlighted")}},{key:"removeHighlights",value:function(){document.getElementsByClassName("highlighted").forEach(function(e){e.classList.remove("highlighted")})}}]),e}();t.default=m},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(0),l=o(s),u=n(1),c=o(u),d=n(2),f=o(d),h=function(){function e(){i(this,e);var t=this;this.elm=document.getElementById("post-form"),null!==this.elm&&(this.locationParent=this.elm.parentNode,this.location=this.elm.nextElementSibling,this.msgElm=this.elm.querySelector("#post-message"),this.fileUploadInProgress=!1,this.fileUploadXhr=null,this.submitAfterFileUpload=!1,this.submitInProgress=!1,this.origDestName=!1,this.origDestValue=!1,this.elm.querySelectorAll(".bb-code").forEach(function(e){e.addEventListener("click",function(e){t.insertBbCode(e.target.dataset.code)})}),this.elm.querySelector(".bb-color-bar").addEventListener("click",function(){t.toggleBbColorBar()}),document.addEventListener("beforeunload",function(e){if(!t.submitInProgress&&null!==t.msgElm.offsetParent&&0!==t.msgElm.value.length)return messages.confirmUnload}),document.querySelectorAll(".create-thread").forEach(function(e){e.addEventListener("click",function(){t.show()})}),document.querySelectorAll(".e-thread-reply").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var n=null,o=e.target.closest(".thread");null!==o&&(n=o.dataset.id),t.threadReply(n)})}),document.querySelectorAll(".e-post-reply").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),t.postReply(e.target.closest(".post").dataset.id),t.msgElm.focus()})}),this.elm.querySelector("#reset-button").addEventListener("click",function(e){e.preventDefault(),t.reset()}),this.elm.querySelector("#post-files").addEventListener("change",function(){t.uploadFile()}),this.elm.querySelector("#remove-file").addEventListener("click",function(){t.deleteUploadedFile(),t.removeFile()}),this.elm.querySelector(".toggle-options").addEventListener("click",function(e){e.preventDefault(),document.getElementById("post-options").toggle()}),this.elm.addEventListener("submit",function(e){t.submit(e)}))}return a(e,[{key:"show",value:function(e){var t=this;if(e||this.reset(),c.default.Captcha.isEnabled()){var n=this.elm.querySelector(".g-recaptcha");n&&!n.dataset.rendered&&c.default.Captcha.render(n,{size:"invisible",callback:function(e){t.submit(null,e)}})}this.elm.classList.add("visible"),null!==this.msgElm.offsetParent&&this.msgElm.focus()}},{key:"hide",value:function(){this.elm.classList.remove("visible")}},{key:"reset",value:function(){this.elm.reset(),null!==this.location?this.locationParent.insertBefore(this.elm,this.location):this.locationParent.appendChild(this.elm),this.removeFile(),this.resetDestination(),this.hide()}},{key:"focus",value:function(){this.msgElm.focus()}},{key:"setDestination",value:function(e,t){this.saveDestination();var n="board";e&&(n="thread");var o=this.elm.querySelector("#post-destination");o.setAttribute("name",n),o.value=t}},{key:"saveDestination",value:function(){var e=this.elm.querySelector("#post-destination"),t=this.elm.querySelector("#label-board");return null!==t?(t.hide(),t.querySelector("select").required=!1,!0):!!this.origDestName||(this.origDestName=e.getAttribute("name"),this.origDestValue=e.value,!0)}},{key:"resetDestination",value:function(){var e=this.elm.querySelector("#post-destination"),t=this.elm.querySelector("#label-board");return null!==t&&(t.show("flex"),t.querySelector("select").required=!0),!this.origDestName||(e.setAttribute("name",this.origDestName),e.value=this.origDestValue,this.origDestName=!1,this.origDestValue=!1,!0)}},{key:"insertBbCode",value:function(e){this.msgElm.insertAtCaret("["+e+"]","[/"+e+"]")}},{key:"toggleBbColorBar",value:function(){this.elm.querySelector("#color-buttons").toggle(),this.msgElm.focus()}},{key:"uploadFile",value:function(){this.elm.querySelector("#remove-file").show(),this.deleteUploadedFile(),this.removeFile(!0);var e=this.elm.querySelector("#post-files"),t=this.elm.querySelector("#file-name");t.value="",this.submitAfterFileUpload=!1,this.updateFileProgressBar(1);for(var n,o=e.dataset.maxsize,i=e.files,r=0,a=0;n=i[a];a++)r+=n.size;if(r>o)return f.default.warning(messages.maxSizeExceeded),this.updateFileProgressBar(0),!1;var s=new FormData;Array.from(i).forEach(function(e){s.append("files[]",e)}),this.fileUploadInProgress=!0;var u=e.value.split("\\").pop().split(".");u.pop(),t.value=u.join(".");var c=this,d=l.default.post("/api/file/create",s,{contentType:null,xhr:function(e){return e.upload?(e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var t=Math.round(e.loaded/e.total*100);t<0?t=0:t>99&&(t=99),c.updateFileProgressBar(t)}}),e):e}}).onEnd(function(){c.fileUploadInProgress=!1}).onLoad(function(e){c.updateFileProgressBar(100);var t=JSON.parse(e.responseText);0!==t.message.length?(c.elm.querySelector("#file-id").value=t.message[0],c.submitAfterFileUpload&&c.submit()):(f.default.error(messages.errorOccurred),c.removeFile(),c.updateFileProgressBar(0))}).onError(function(){c.removeFile(),c.updateFileProgressBar(0)});this.fileUploadXhr=d.getXhrObject()}},{key:"removeFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null!==this.fileUploadXhr&&(this.fileUploadXhr.abort(),this.fileUploadXhr=null),e||(this.elm.querySelector("#remove-file").hide(),this.elm.querySelector("#post-files").value=""),this.elm.querySelector("#file-id").value="",this.elm.querySelector("#file-name").value="",this.updateFileProgressBar(0),this.submitAfterFileUpload=!1}},{key:"deleteUploadedFile",value:function(){var e=this.elm.querySelector("#file-id");""!==e.value&&l.default.post("/api/file/delete",{fileId:e.value})}},{key:"updateFileProgressBar",value:function(e){e<0?e=0:e>100&&(e=100);var t=this.elm.querySelector(".file-progress"),n=t.querySelector("div");0===e?(n.style.width=0,t.classList.remove("in-progress")):(n.style.width=e+"%",t.classList.add("in-progress"))}},{key:"threadReply",value:function(e){null!==e&&(c.default.Thread.getElm(e).querySelector(".thread-content").appendChild(this.elm),this.show(!0),this.setDestination(!0,e)),this.msgElm.focus()}},{key:"postReply",value:function(e){var t=c.default.getSelectionText();c.default.Post.getElm(e).appendChild(this.elm),this.show(!0),this.setDestination(!0,this.elm.closest(".thread").dataset.id),this.msgElm.focus();var n="";"\n"===this.msgElm.value.substr(-1)?n+="\n":0!==this.msgElm.value.length&&(n+="\n\n"),n+=">>"+e+"\n",""!==t&&(n+=">"+t.replace(/(\r\n|\n|\r)/g,"$1>")+"\n"),this.msgElm.value=this.msgElm.value.trim()+n}},{key:"submit",value:function(e){var t=this;if("object"===(void 0===e?"undefined":r(e))&&null!==e&&e.preventDefault(),this.submitInProgress)return!1;this.submitInProgress=!0;var n=this.elm.querySelector('input[type="submit"].button');if(this.fileUploadInProgress)return n.disabled=!0,this.submitAfterFileUpload=!0,!1;this.elm.querySelector("#post-files").value="";var o=new FormData(this.elm);l.default.post(this.elm.getAttribute("action"),o,{contentType:null}).onLoad(function(e){var n=document.getElementById("post-destination"),i=void 0;if(null!==(i="thread"!==n.getAttribute("name")?null:n.value))c.default.Thread.AutoUpdate.runOnce(i),t.reset();else if(0===e.responseText.length)c.default.pageReload();else{var r=JSON.parse(e.responseText);void 0===r.message?f.default.error(messages.errorOccurred):window.location="/"+o.get("board")+"/"+r.message}}).onEnd(function(){n.disabled=!1,t.submitInProgress=!1,c.default.Captcha.reset()})}}]),e}();t.default=h},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),s=o(a),l=n(1),u=o(l),c=n(2),d=o(c),f=function(){function e(){i(this,e);var t=this;document.addEventListener("volumechange",function(){localStorage.setItem("videoVolume",t.volume)})}return r(e,[{key:"bindEvents",value:function(e){var t=this;e.querySelectorAll(".thumbnail .image").forEach(function(e){e.addEventListener("click",t.expand)}),e.querySelectorAll(".thumbnail .media").forEach(function(e){e.addEventListener("click",function(e){t.playMedia(e,t.stopAllMedia)})}),e.querySelectorAll(".e-stop-media").forEach(function(e){e.addEventListener("click",t.stopAllMedia)})}},{key:"delete",value:function(e){if(!confirm(messages.confirmDeleteFile))return!1;s.default.post("/api/post/deletefile",{post_id:e,loadFunction:function(){this.getElm(e).find("figure").remove(),d.default.success(messages.fileDeleted)}})}},{key:"expand",value:function(e){function t(e,t){function n(e){e.target.removeEventListener("load",o),delete e.target.dataset.expanding,clearTimeout(e.target.loading);var t=e.target.parentNode.querySelector("div.overlay");null!==t&&t.remove()}var o=n;e.dataset.expanding=!0,e.loading=setTimeout(function(){var t=document.createElement("div");t.classList.add("overlay","center"),t.innerHTML=u.default.spinnerHtml(),e.parentNode.appendChild(t)},200),e.addEventListener("load",o),e.setAttribute("src",t)}if(e.preventDefault(),void 0===e.target.dataset.expanded)e.target.dataset.expanded=e.target.getAttribute("src"),t(e.target,e.target.parentNode.getAttribute("href")),e.target.closest(".post-file").classList.remove("thumbnail"),e.target.closest(".message").classList.add("full");else{t(e.target,e.target.dataset.expanded),delete e.target.dataset.expanded,e.target.closest(".post-file").classList.add("thumbnail"),e.target.closest(".message").classList.remove("full");var n=e.target.getBoundingClientRect().top+window.scrollY;n<window.scrollY&&window.scrollTo(0,n)}}},{key:"playMedia",value:function(e,t){e.preventDefault(),t();var n=e.target.closest("figure").dataset.id;if(void 0!==e.target.dataset.loading)return!1;e.target.dataset.loading=!0;var o=setTimeout(function(){var t=document.createElement("div");t.classList.add("overlay","bottom","left"),t.innerHTML=u.default.spinnerHtml(),e.target.appendChild(t)},200);s.default.post("/api/file/getmediaplayer",{fileId:n}).onLoad(function(t){var n=e.target.closest(".post-file");n.classList.remove("thumbnail"),n.classList.add("media-player-container"),e.target.closest(".message").classList.add("full");var o=document.createElement("template");o.innerHTML=t.responseText,u.default.initElement(o.content),n.insertBefore(o.content,n.firstElementChild);var i=localStorage.getItem("videoVolume");null!==i&&(e.target.parentNode.querySelector("video").volume=i)}).onEnd(function(){clearTimeout(o),e.target.querySelectorAll("div.overlay").forEach(function(e){e.remove()}),delete e.target.dataset.loading})}},{key:"stopAllMedia",value:function(){document.querySelectorAll(".media-player-container").forEach(function(e){var t=e.querySelector("video");t.pause(),t.remove(),e.classList.remove("media-player-container"),e.classList.add("thumbnail")})}}]),e}();t.default=f},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),a=function(e){return e&&e.__esModule?e:{default:e}}(r),s=function(){function e(){o(this,e);var t=this;document.querySelector(".switch-theme").addEventListener("click",function(){t.switchVariation()}),document.getElementById("sidebar").addEventListener("click",function(e){e.offsetX>document.getElementById("sidebar").clientWidth&&document.getElementById("sidebar").classList.toggle("visible")}),document.querySelector(".sidebar-toggle").addEventListener("click",function(){document.getElementById("sidebar").classList.toggle("visible")}),document.querySelectorAll("body > :not(#topbar):not(#sidebar)").forEach(function(e){e.addEventListener("click",function(e){var t=document.getElementById("sidebar");t.classList.contains("visible")&&t.classList.remove("visible")})})}return i(e,[{key:"toggleSidebar",value:function(){if(null!==document.getElementById("hide-sidebar"))document.getElementById("hide-sidebar").remove(),document.getElementById("sidebar").classList.remove("visible"),a.default.post("/api/user/preferences/set",{hideSidebar:"false"});else{var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("id","hide-sidebar"),e.setAttribute("href",config.staticUrl+"/css/hide_sidebar.css"),document.querySelector("head").appendChild(e),a.default.post("/api/user/preferences/set",{hideSidebar:"true"})}}},{key:"switchVariation",value:function(){var e=document.querySelectorAll("head .css");e=e[e.length-1];var t=e.dataset.light,n=e.dataset.dark,o="true"===e.dataset.darktheme,i=void 0,r=void 0;o?(i=t,r=!1):(i=n,r=!0);var s=e.cloneNode();s.setAttributes({href:i,"data-darkTheme":r}),s.appendAfter(e);setTimeout(function(){e.remove()},5e3);a.default.post("/api/user/preferences/set",{darkTheme:r})}}]),e}();t.default=s},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),s=o(a),l=n(1),u=o(l),c=n(17),d=o(c),f=n(19),h=o(f),m=n(18),p=o(m),v=function(){function e(){i(this,e);var t=this;this.AutoUpdate=new d.default,this.Hide=new h.default,this.Follow=new p.default,document.querySelectorAll(".replies-buttons").forEach(function(e){e.querySelector(".e-more-replies").addEventListener("click",t.expand),e.querySelector(".e-less-replies").addEventListener("click",t.shrink)})}return r(e,[{key:"getElm",value:function(e){return document.getElementById("thread-"+e)}},{key:"toggleLock",value:function(e){0==this.getElm(e).find("h3 a .icon-lock").length?$.post("/scripts/threads/lock",{threadId:e}).done(function(){YB.thread.getElm(e).find("h3 a").prepend('<span class="icon-lock icon"></span>'),toastr.success(messages.threadLocked)}):$.post("/scripts/threads/unlock",{threadId:e}).done(function(){YB.thread.getElm(e).find("h3 a .icon-lock").remove(),toastr.success(messages.threadUnlocked)})}},{key:"toggleSticky",value:function(e){0==this.getElm(e).find("h3 a .icon-lock").length?$.post("/scripts/threads/stick",{threadId:e}).done(function(){YB.thread.getElm(e).find("h3 a").prepend('<span class="icon-pushpin icon"></span>'),toastr.success(messages.threadStickied)}):$.post("/scripts/threads/unstick",{threadId:e}).done(function(){YB.thread.getElm(e).find("h3 a .icon-pushpin").remove(),toastr.success(messages.threadUnstickied)})}},{key:"shrink",value:function(e){var t=e.target.closest(".thread");t.querySelector(".more-replies-container").innerHTML="",t.querySelector(".e-more-replies").show(),t.classList.remove("expanded")}},{key:"expand",value:function(e){var t=e.target.closest(".thread"),n=t.dataset.id,o=t.querySelector(".reply").dataset.id;s.default.post("/api/thread/getreplies",{threadId:n,fromId:o,count:100}).onLoad(function(e){var n=document.createElement("template");n.innerHTML=e.responseText,u.default.initElement(n.content),n.content.querySelectorAll(".reply").length<100&&t.querySelector(".e-more-replies").hide();var o=t.querySelector(".more-replies-container"),i=o.querySelector(".reply");null===i?o.appendChild(n.content):t.querySelector(".more-replies-container").insertBefore(n.content,i),t.classList.add("expanded")})}}]),e}();t.default=v},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(1),s=o(a),l=n(0),u=o(l),c=n(2),d=o(c),f=function(){function e(){i(this,e);var t=this;this.threadId=!1,this.nextLoadDelay=2e3,this.newReplies=0,this.lastUpdateNewReplies=0,this.runCount=0,this.nowLoading=!1,this.isActive=!1,this.nextRunTimeout=0,this.startDelayTimeout=0,this.originalDocTitle=document.title,document.querySelectorAll(".thread .e-get-replies").forEach(function(e){e.addEventListener("click",function(n){n.preventDefault(),t.runOnce(e.closest(".thread").dataset.id)})})}return r(e,[{key:"run",value:function(e){if(this.nowLoading)return!1;this.nextLoadDelay=this.nextLoadDelay*(0===this.runCount?1:this.runCount),this.nextLoadDelay>3e4&&(this.nextLoadDelay=3e4),this.runCount>40&&this.stop(),e&&(this.runCount=0,this.isActive&&this.restart());var t=s.default.Thread.getElm(this.threadId),n=t.querySelector(".reply:last-of-type");n=null===n?0:n.getAttribute("id").replace("post-",""),this.nowLoading=!0;var o=this;u.default.post("/api/thread/getreplies",{threadId:this.threadId,fromId:n,newest:!0,xhr:function(e){return e.responseType="document",e}}).onLoad(function(n){if(e&&0===n.responseText.length)return void d.default.info(messages.noNewReplies);var i=document.createElement("template");i.innerHTML=n.responseText,s.default.initElement(i.content),o.lastUpdateNewReplies=i.querySelectorAll(".message").length,o.newReplies+=o.lastUpdateNewReplies,0===o.lastUpdateNewReplies?++o.runCount:o.runCount=0,t.querySelector(".replies").appendChild(i.content),e||(o.nextRunTimeout=setTimeout(function(){o.start()},o.nextLoadDelay))}).onError(function(){o.stop()}).onEnd(function(){if(o.nowLoading=!1,!document.hasFocus()&&o.newReplies>0&&document.body.classList.contains("thread-page")){document.title="("+o.newReplies+") "+o.originalDocTitle;var e=document.querySelector(".replies");e.querySelector("hr").remove();var t=document.createElement("hr");e.insertBefore(t,e.querySelector(".reply:eq(-"+o.newReplies+")"))}else 0!==o.newReplies&&(o.newReplies=0)})}},{key:"runOnce",value:function(e){this.threadId=e,this.run(!0)}},{key:"start",value:function(){this.isActive=!0,this.startDelayTimeout&&clearTimeout(this.startDelayTimeout);var e=this;return this.threadId=$(".thread:first").data("id"),this.startDelayTimeout=setTimeout(function(){e.run(!1)},1e3),!0}},{key:"stop",value:function(){return!this.isActive||(this.startDelayTimeout&&clearTimeout(this.startDelayTimeout),this.isActive=!1,this.reset(),!0)}},{key:"restart",value:function(){this.stop(),this.start()}},{key:"reset",value:function(){this.nowLoading=!1,this.newReplies=0,this.runCount=0,document.title!==this.originalDocTitle&&(document.title=this.originalDocTitle),this.nextRunTimeout&&clearTimeout(this.nextRunTimeout)}}]),e}();t.default=f},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),s=o(a),l=n(1),u=o(l),c=function(){function e(){i(this,e)}return r(e,[{key:"add",value:function(e){this.doAjax(e,"/api/thread/follow/add")}},{key:"remove",value:function(e){this.doAjax(e,"/api/thread/follow/remove")}},{key:"markAllRead",value:function(){$(".icon-bookmark .unread-count").hide(),$("h3 .notification-count").hide(),$.post("/api/thread/follow/markallread").fail(function(){$(".icon-bookmark .unread-count").show(),$("h3 .notification-count").show()})}},{key:"toggleButton",value:function(e){var t=u.default.thread.getElm(e).find(".followbutton");t.hasClass("add")?t.removeClass("icon-bookmark-add add").addClass("icon-bookmark-remove remove"):t.removeClass("icon-bookmark-remove remove").addClass("icon-bookmark-add add")}},{key:"doAjax",value:function(e,t){this.toggleButton(e),s.default.post(t,{threadId:e}).fail(function(){u.default.Thread.Follow.toggleButton(e)})}}]),e}();t.default=c},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(r),s=function(){function e(){o(this,e)}return i(e,[{key:"add",value:function(e){a.default.Thread.getElm(e).hide(),$.post("/scripts/threads/hide",{threadId:e}).onError(function(){a.default.Thread.getElm(e).show()})}},{key:"remove",value:function(e){a.default.Thread.getElm(e).show(),YQuery.post("/scripts/threads/restore",{threadId:e}).onError(function(){a.default.Thread.getElm(e).hide()})}}]),e}();t.default=s}]);